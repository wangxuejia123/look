(function(r){var b=window,d=setTimeout;var x=function(){var c=document.createElement("canvas");return(typeof c.getContext)=="function"};window.Snow=function(c,f){(function(){var h=0;var i=["webkit","moz"];for(var g=0;g<i.length&&!window.requestAnimationFrame;++g){window.requestAnimationFrame=window[i[g]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[i[g]+"CancelAnimationFrame"]||window[i[g]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(m,j){var k=14;var l=window.setTimeout(function(){m(k)},k);return l}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(j){clearTimeout(j)}}}());this.settings=f,this.flakes=[],this.flakeCount=f.count,this.mx=-100,this.my=-100,this.init(c)};Snow.prototype.init=function(j){this.canvas=j.get(0),this.ctx=this.canvas.getContext("2d"),this.canvas.width=b.innerWidth,this.canvas.height=r(j.get(0)).attr("height"),this.flakes=[];for(var h=0;h<this.flakeCount;h++){var c=Math.floor(Math.random()*this.canvas.width),m=Math.floor(Math.random()*this.canvas.height),g=Math.floor(100*Math.random())%this.settings.size+2,l=Math.floor(100*Math.random())%this.settings.speed+Math.random()*g/10+0.5,f=0.5*Math.random()+this.settings.opacity;this.flakes.push({speed:l,velY:l,velX:0,x:c,y:m,size:g,stepSize:Math.random()/30,step:0,angle:180,opacity:f})}1==this.settings.interaction&&this.canvas.addEventListener("mousemove",function(i){this.mx=i.clientX,this.my=i.client});var k=this;if(typeof this.settings.image==="string"){this.image=r("<img src='"+this.settings.image+"' style='display: none'>")}this.snow()},Snow.prototype.snow=function(){var f=this,c=function(){f.ctx.clearRect(0,0,f.canvas.width,f.canvas.height);for(var l=0;l<f.flakeCount;l++){var m=f.flakes[l],D=f.mx,B=f.my,E=100,h=m.x,C=m.y,A=Math.sqrt((h-D)*(h-D)+(C-B)*(C-B));if(E>A){var j=E/(A*A),g=(D-h)/A,F=(B-C)/A,z=j/2;m.velX-=z*g,m.velY-=z*F}else{switch(m.velX*=0.98,m.velY<=m.speed&&(m.velY=m.speed),f.settings.windPower){case !1:m.velX+=Math.cos(m.step+=0.05)*m.stepSize;break;case 0:m.velX+=Math.cos(m.step+=0.05)*m.stepSize;break;default:m.velX+=0.01+f.settings.windPower/100}}if(m.y+=m.velY,m.x+=m.velX,(m.y>=f.canvas.height||m.y<=0)&&f.resetFlake(m),(m.x>=f.canvas.width||m.x<=0)&&f.resetFlake(m),0==f.settings.image){var k=f.ctx.createRadialGradient(m.x,m.y,0,m.x,m.y,m.size-1);k.addColorStop(0,f.settings.startColor),k.addColorStop(1,f.settings.endColor),f.ctx.fillStyle=k,f.ctx.beginPath(),f.ctx.arc(m.x,m.y,m.size,0,2*Math.PI),f.ctx.fill()}else{f.ctx.drawImage(f.image.get(0),m.x,m.y,2*m.size,2*m.size)}}b.cancelAnimationFrame(c),b.requestAnimationFrame(c)};c()},Snow.prototype.resetFlake=function(f){if(0==this.settings.windPower||0==this.settings.windPower){f.x=Math.floor(Math.random()*this.canvas.width),f.y=0}else{if(this.settings.windPower>0){var g=Array(Math.floor(Math.random()*this.canvas.width),0),c=Array(0,Math.floor(Math.random()*this.canvas.height)),h=Array(g,c),i=h[Math.floor(Math.random()*h.length)];f.x=i[0],f.y=i[1]}else{var g=Array(Math.floor(Math.random()*this.canvas.width),0),c=Array(this.canvas.width,Math.floor(Math.random()*this.canvas.height)),h=Array(g,c),i=h[Math.floor(Math.random()*h.length)];f.x=i[0],f.y=i[1]}}f.size=Math.floor(100*Math.random())%this.settings.size+2,f.speed=Math.floor(100*Math.random())%this.settings.speed+Math.random()*f.size/10+0.5,f.velY=f.speed,f.velX=0,f.opacity=0.5*Math.random()+this.settings.opacity};r.fn.faiSnow=function(){var c=x();c&&r(this).each(function(f,h){var g={};r.each(h.attributes,function(i,j){g[r.camelCase(j.name)]=Number(Number(j.value))?Number(j.value):j.value});if(typeof g.image==="string"&&g.image==="false"){g.image=false}new Snow(r(h),{speed:1||0,interaction:g.interaction||!0,size:g.size||2,count:g.count||200,opacity:g.opacity||1,startColor:g.startColor||"rgba(255,255,255,1)",endColor:g.endColor||"rgba(255,255,255,0)",windPower:g.windPower||0,image:g.image||!1})})};function o(g,f,h){if(g.addEventListener){g.addEventListener(f,h,false)}else{g.attachEvent&&g.attachEvent("on"+f,h)}}function t(f){if(typeof window.onload!="function"){window.onload=f}else{var c=window.onload;window.onload=function(){c();f()}}}function s(){var f={};for(type in {Top:"",Left:""}){var c=type=="Top"?"Y":"X";if(typeof window["page"+c+"Offset"]!="undefined"){f[type.toLowerCase()]=window["page"+c+"Offset"]}else{c=document.documentElement.clientHeight?document.documentElement:document.body;f[type.toLowerCase()]=c["scroll"+type]}}return f}function n(){var f=document.body,c;if(window.innerHeight){c=window.innerHeight}else{if(f.parentElement.clientHeight){c=f.parentElement.clientHeight}else{if(f&&f.clientHeight){c=f.clientHeight}}}return c}var p=true;var u=true;var e=null;var v=[];var w=function(f,c){clearInterval(e);v=[];e=setInterval(function(){u&&c>v.length&&Math.random()<c*0.0025&&v.push(new q(f));!u&&!v.length&&clearInterval(e);for(var g=s().top,i=n(),h=v.length-1;h>=0;h--){if(v[h]){if(v[h].top<g||v[h].top+v[h].size+1>g+i){v[h].remove();v[h]=null;v.splice(h,1)}else{v[h].move();v[h].draw()}}}},40);o(window,"scroll",function(){for(var g=v.length-1;g>=0;g--){v[g].draw()}})};var a=function(){clearInterval(e);do{v.pop().remove()}while(v.length)};function q(c){this.parent=document.body;this.createEl(this.parent,c);this.size=Math.random()*5+5;this.el.style.width=Math.round(this.size)+"px";this.el.style.height=Math.round(this.size)+"px";this.maxLeft=document.body.offsetWidth-this.size;this.maxTop=document.body.offsetHeight-this.size;this.left=Math.random()*this.maxLeft;this.top=s().top+1;this.angle=1.4+0.2*Math.random();this.minAngle=1.4;this.maxAngle=1.6;this.angleDelta=0.01*Math.random();this.speed=2+Math.random()}q.prototype={createEl:function(f,c){this.el=document.createElement("img");this.el.classname="nicesnowclass";this.el.setAttribute("src",c||"./imgs/snow.png");this.el.style.position="absolute";this.el.style.display="block";this.el.style.zIndex="99999";this.parent.appendChild(this.el)},move:function(){if(this.angle<this.minAngle||this.angle>this.maxAngle){this.angleDelta=-this.angleDelta}this.angle+=this.angleDelta;this.left+=this.speed*Math.cos(this.angle*Math.PI);this.top-=this.speed*Math.sin(this.angle*Math.PI);if(this.left<0){this.left=this.maxLeft}else{if(this.left>this.maxLeft){this.left=0}}},draw:function(){this.el.style.top=Math.round(this.top)+"px";this.el.style.left=Math.round(this.left)+"px"},remove:function(){this.parent.removeChild(this.el);this.parent=this.el=null}}})(jQuery);(function(g){var h;var b=g(window);function j(k){return k[k.length-1]=="%"}function f(){var l=document.createElement("canvas");var m=l.getContext("webgl")||l.getContext("experimental-webgl");var k=m&&m.getExtension("OES_texture_float")&&m.getExtension("OES_texture_float_linear");return k}var d=f();function e(m,s,l){function o(t,v){var u=h.createShader(t);h.shaderSource(u,v);h.compileShader(u);if(!h.getShaderParameter(u,h.COMPILE_STATUS)){throw new Error("compile error: "+h.getShaderInfoLog(u))}return u}var n={};n.id=h.createProgram();h.attachShader(n.id,o(h.VERTEX_SHADER,m));h.attachShader(n.id,o(h.FRAGMENT_SHADER,s));h.linkProgram(n.id);if(!h.getProgramParameter(n.id,h.LINK_STATUS)){throw new Error("link error: "+h.getProgramInfoLog(n.id))}n.uniforms={};n.locations={};h.useProgram(n.id);h.enableVertexAttribArray(0);var k,q,r=/uniform (\w+) (\w+)/g,p=m+s;while((match=r.exec(p))!=null){k=match[2];n.locations[k]=h.getUniformLocation(n.id,k)}return n}function i(l,k){h.activeTexture(h.TEXTURE0+(k||0));h.bindTexture(h.TEXTURE_2D,l)}var a=function(l,u){var r=this;this.$el=g(l);this.$el.addClass("jquery-ripples");var k=(/url\(["']?([^"']*)["']?\)/.exec(this.$el.css("background-image")));if(k==null){return}k=k[1];this.interactive=u.interactive;this.resolution=u.resolution||256;this.textureDelta=new Float32Array([1/this.resolution,1/this.resolution]);this.perturbance=u.perturbance;this.dropRadius=u.dropRadius;var m=document.createElement("canvas");m.width=this.$el.innerWidth();m.height=this.$el.innerHeight();this.canvas=m;this.canvasWidth=m.width;this.canvasHeight=m.width;this.$canvas=g(m);this.$canvas.css({position:"absolute",left:0,top:0,right:0,bottom:0,pointerEvents:"none"});this.$el.append(m);this.context=h=m.getContext("webgl")||m.getContext("experimental-webgl");h.getExtension("OES_texture_float");h.getExtension("OES_texture_float_linear");this.$el.on("mousemove.ripples",function(v){if(r.visible&&r.running&&r.interactive){r.dropAtMouse(v,r.dropRadius,0.01)}}).on("mousedown.ripples",function(v){if(r.visible&&r.running&&r.interactive){r.dropAtMouse(v,r.dropRadius*1.5,0.14)}});this.textures=[];this.framebuffers=[];for(var p=0;p<2;p++){var s=h.createTexture();var t=h.createFramebuffer();h.bindFramebuffer(h.FRAMEBUFFER,t);t.width=this.resolution;t.height=this.resolution;h.bindTexture(h.TEXTURE_2D,s);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,this.resolution,this.resolution,0,h.RGBA,h.FLOAT,null);h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,s,0);if(h.checkFramebufferStatus(h.FRAMEBUFFER)!=h.FRAMEBUFFER_COMPLETE){throw new Error("Rendering to this texture is not supported (incomplete framebuffer)")}h.bindTexture(h.TEXTURE_2D,null);h.bindFramebuffer(h.FRAMEBUFFER,null);this.textures.push(s);this.framebuffers.push(t)}this.running=true;this.quad=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,this.quad);h.bufferData(h.ARRAY_BUFFER,new Float32Array([-1,-1,+1,-1,+1,+1,-1,+1]),h.STATIC_DRAW);this.initShaders();var o=new Image;o.crossOrigin="";o.onload=function(){h=r.context;function v(y){return(y&(y-1))==0}var x=(v(o.width)&&v(o.height))?h.REPEAT:h.CLAMP_TO_EDGE;r.backgroundWidth=o.width;r.backgroundHeight=o.height;var w=h.createTexture();h.bindTexture(h.TEXTURE_2D,w);h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,1);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,x);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,x);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,o);r.backgroundTexture=w};var q=this.canvas.toDataURL(k);o.src=q;this.visible=true;function n(){r.step();cancelAnimationFrame(n);requestAnimationFrame(n)}n()};a.DEFAULTS={resolution:256,dropRadius:20,perturbance:0.03,interactive:true};a.prototype={step:function(){h=this.context;if(!this.visible||!this.backgroundTexture){return}this.computeTextureBoundaries();if(this.running){this.update()}this.render()},drawQuad:function(){h.bindBuffer(h.ARRAY_BUFFER,this.quad);h.vertexAttribPointer(0,2,h.FLOAT,false,0,0);h.drawArrays(h.TRIANGLE_FAN,0,4)},render:function(){h.viewport(0,0,this.canvasWidth,this.canvasHeight);h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);h.useProgram(this.renderProgram.id);i(this.backgroundTexture,0);i(this.textures[0],1);var l=this.renderProgram.locations.topLeft;var k=this.renderProgram.locations.bottomRight;var n=this.renderProgram.locations.containerRatio;var m=this.renderProgram.locations.samplerBackground;var o=this.renderProgram.locations.samplerRipples;h.uniform2fv(l,this.renderProgram.uniforms.topLeft);h.uniform2fv(k,this.renderProgram.uniforms.bottomRight);h.uniform2fv(n,this.renderProgram.uniforms.containerRatio);h.uniform1i(m,0);h.uniform1i(o,1);this.drawQuad()},update:function(){h.viewport(0,0,this.resolution,this.resolution);for(var k=0;k<2;k++){h.bindFramebuffer(h.FRAMEBUFFER,this.framebuffers[k]);i(this.textures[1-k]);h.useProgram(this.updateProgram[k].id);this.drawQuad()}h.bindFramebuffer(h.FRAMEBUFFER,null)},computeTextureBoundaries:function(){var o=this.$el.offset();var x=this.$el.offset().left;var l=this.$el.offset().Top;var A=this.$el.css("background-size");var q=this.$el.css("background-attachment");var w=this.$el.css("background-position").split(" ");var v=q=="fixed"?b:this.$el;var z=v.offset()||{left:pageXOffset,top:pageYOffset};var s=z.left;var C=z.top;var t=v.innerWidth();var m=v.innerHeight();var y=Math.max(this.canvasWidth,this.canvasHeight);var u=this.backgroundWidth;if(A=="cover"){var B=Math.max(t/u,m/this.backgroundHeight);var n=u*B;var k=this.backgroundHeight*B}else{if(A=="contain"){var B=Math.min(t/u,m/this.backgroundHeight);var n=u*B;var k=this.backgroundHeight*B}else{A=A.split(" ");var n=A[0]||"";var k=A[1]||n;if(j(n)){n=t*parseFloat(n)/100}else{if(n!="auto"){n=parseFloat(n)}}if(j(k)){k=m*parseFloat(k)/100}else{if(k!="auto"){k=parseFloat(k)}}if(n=="auto"&&k=="auto"){n=u;k=this.backgroundHeight}else{if(n=="auto"){n=u*(k/this.backgroundHeight)}if(k=="auto"){k=this.backgroundHeight*(n/u)}}}}var r=w[0]||"";var p=w[1]||r;if(r=="left"){r=s}else{if(r=="center"){r=s+t/2-n/2}else{if(r=="right"){r=s+t-n}else{if(j(r)){r=s+(t-n)*parseFloat(r)/100}else{r=parseFloat(r)}}}}if(p=="top"){p=C}else{if(p=="center"){p=C+m/2-k/2}else{if(p=="bottom"){p=C+m-k}else{if(j(p)){p=C+(m-k)*parseFloat(p)/100}else{p=parseFloat(p)}}}}this.renderProgram.uniforms.topLeft=new Float32Array([(x-r)/n,(l-p)/k]);this.renderProgram.uniforms.bottomRight=new Float32Array([((x-r)/n+this.canvasWidth)/n,((l-p)/k+this.canvasHeight)/k]);this.renderProgram.uniforms.containerRatio=new Float32Array([this.canvasWidth/y,this.canvasHeight/y])},initShaders:function(){var k=["attribute vec2 vertex;","varying vec2 coord;","void main() {","coord = vertex * 0.5 + 0.5;","gl_Position = vec4(vertex, 0.0, 1.0);","}"].join("\n");this.dropProgram=e(k,["precision highp float;","const float PI = 3.141592653589793;","uniform sampler2D texture;","uniform vec2 center;","uniform float radius;","uniform float strength;","varying vec2 coord;","void main() {","vec4 info = texture2D(texture, coord);","float drop = max(0.0, 1.0 - length(center * 0.5 + 0.5 - coord) / radius);","drop = 0.5 - cos(drop * PI) * 0.5;","info.r += drop * strength;","gl_FragColor = info;","}"].join("\n"));this.updateProgram=[0,0];this.updateProgram[0]=e(k,["precision highp float;","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 coord;","void main() {","vec4 info = texture2D(texture, coord);","vec2 dx = vec2(delta.x, 0.0);","vec2 dy = vec2(0.0, delta.y);","float average = (","texture2D(texture, coord - dx).r +","texture2D(texture, coord - dy).r +","texture2D(texture, coord + dx).r +","texture2D(texture, coord + dy).r",") * 0.25;","info.g += (average - info.r) * 2.0;","info.g *= 0.995;","info.r += info.g;","gl_FragColor = info;","}"].join("\n"));h.uniform2fv(this.updateProgram[0].locations.delta,this.textureDelta);this.updateProgram[1]=e(k,["precision highp float;","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 coord;","void main() {","vec4 info = texture2D(texture, coord);","vec3 dx = vec3(delta.x, texture2D(texture, vec2(coord.x + delta.x, coord.y)).r - info.r, 0.0);","vec3 dy = vec3(0.0, texture2D(texture, vec2(coord.x, coord.y + delta.y)).r - info.r, delta.y);","info.ba = normalize(cross(dy, dx)).xz;","gl_FragColor = info;","}"].join("\n"));h.uniform2fv(this.updateProgram[1].locations.delta,this.textureDelta);this.renderProgram=e(["precision highp float;","attribute vec2 vertex;","uniform vec2 topLeft;","uniform vec2 bottomRight;","uniform vec2 containerRatio;","varying vec2 ripplesCoord;","varying vec2 backgroundCoord;","void main() {","backgroundCoord = mix(topLeft, bottomRight, vertex * 0.5 + 0.5);","backgroundCoord.y = 1.0 - backgroundCoord.y;","ripplesCoord = vec2(vertex.x, -vertex.y) * containerRatio * 0.5 + 0.5;","gl_Position = vec4(vertex.x, -vertex.y, 0.0, 1.0);","}"].join("\n"),["precision highp float;","uniform sampler2D samplerBackground;","uniform sampler2D samplerRipples;","uniform float perturbance;","varying vec2 ripplesCoord;","varying vec2 backgroundCoord;","void main() {","vec2 offset = -texture2D(samplerRipples, ripplesCoord).ba;","float specular = pow(max(0.0, dot(offset, normalize(vec2(-0.6, 1.0)))), 4.0);","gl_FragColor = texture2D(samplerBackground, backgroundCoord + offset * perturbance) + specular;","}"].join("\n"));h.uniform1f(this.renderProgram.locations.perturbance,this.perturbance)},dropAtMouse:function(l,k,m){this.drop(l.pageX-this.$el.offset().left,l.pageY-this.$el.offset().top,k,m)},drop:function(q,p,o,k){var n=this;h=this.context;var s=this.$el.outerWidth();var m=this.$el.outerHeight();var l=Math.max(s,m);o=o/l;var r=new Float32Array([(2*q-s)/l,(m-2*p)/l]);h.viewport(0,0,this.resolution,this.resolution);h.bindFramebuffer(h.FRAMEBUFFER,this.framebuffers[0]);i(this.textures[1]);h.useProgram(this.dropProgram.id);h.uniform2fv(this.dropProgram.locations.center,r);h.uniform1f(this.dropProgram.locations.radius,o);h.uniform1f(this.dropProgram.locations.strength,k);this.drawQuad();var u=this.framebuffers[0];this.framebuffers[0]=this.framebuffers[1];this.framebuffers[1]=u;u=this.textures[0];this.textures[0]=this.textures[1];this.textures[1]=u;h.bindFramebuffer(h.FRAMEBUFFER,null)},destroy:function(){this.context.getExtension("WEBGL_lose_context").loseContext();this.canvas.remove();this.$el.off(".ripples");this.$el.removeClass("jquery-ripples").removeData("ripples")},show:function(){this.$canvas.show();this.$el.css("backgroundImage","none");this.visible=true},hide:function(){this.$canvas.hide();this.$el.css("backgroundImage","");this.visible=false},pause:function(){this.running=false},play:function(){this.running=true},set:function(l,k){switch(l){case"interactive":this.interactive=k;break}}};var c=g.fn.faiRipples;g.fn.faiRipples=function(l){if(!d){console.log("Your browser does not support at least one of the following: WebGL, OES_texture_float extension, OES_texture_float_linear extension.");return}var k=(arguments.length>1)?Array.prototype.slice.call(arguments,1):undefined;return this.each(function(){var o=g(this);var n=o.data("ripples");var m=g.extend({},a.DEFAULTS,o.data(),typeof l=="object"&&l);if(!n&&typeof l=="string"){return}if(!n){o.data("ripples",(n=new a(this,m)))}else{if(typeof l=="string"){a.prototype[l].apply(n,k)}}})};g.fn.faiRipples.Constructor=a;g.fn.faiRipples.noConflict=function(){g.fn.faiRipples=c;return this}})(jQuery);(function(e){var c=function(){var h=document.createElement("canvas");return(typeof h.getContext)=="function"};function d(h,i){if(this===window){return new d(h,i)}this.img=i;var k={opacity:1,blur:10,crop:[0,0,this.img.naturalWidth,this.img.naturalHeight],enableSizeChange:true,parentElement:null,fps:30,fillStyle:"#8ED6FF",enableCollisions:true,gravityThreshold:3,gravityAngle:Math.PI/2,gravityAngleVariance:0,reflectionScaledownFactor:5,reflectionDropMappingWidth:200,reflectionDropMappingHeight:200,width:this.img.clientWidth,height:this.img.clientHeight,position:"absolute",top:0,left:0,rainyEffect:0};for(var j in k){if(typeof h[j]==="undefined"){h[j]=k[j]}}this.options=h;this.drops=[];this.canvas=this.prepareCanvas();this.prepareBackground();this.prepareGlass();this.reflection=this.REFLECTION_MINIATURE;this.trail=this.TRAIL_DROPS;this.gravity=this.GRAVITY_NON_LINEAR;this.collision=this.COLLISION_SIMPLE;this.setRequestAnimFrame();this.beginTime=new Date().getTime()}d.prototype.prepareCanvas=function(){var h=document.createElement("canvas");h.style.position=this.options.position;h.style.top=this.options.top;h.style.left=this.options.left;h.className="rainyday-canvas";h.width=this.img.width;h.height=this.img.height;if(this.options.parentElement==null){this.img.parentElement.appendChild(h)}else{this.options.parentElement.appendChild(h)}if(this.options.enableSizeChange){}return h};d.prototype.setResizeHandler=function(){if(window.onresize!==null){window.setInterval(this.checkSize.bind(this),100)}else{window.onresize=this.checkSize.bind(this);window.onorientationchange=this.checkSize.bind(this)}};d.prototype.checkSize=function(){var o=this.img.clientWidth;var j=this.img.clientHeight;var i=this.img.offsetLeft;var m=this.img.offsetTop;var h=this.canvas.width;var l=this.canvas.height;var n=this.canvas.offsetLeft;var k=this.canvas.offsetTop;if(h!==o||l!==j){this.canvas.width=o;this.canvas.height=j;this.prepareBackground();this.glass.width=this.canvas.width;this.glass.height=this.canvas.height;this.prepareReflections()}if(n!==i||k!==m){this.canvas.offsetLeft=i;this.canvas.offsetTop=m}};d.prototype.animateDrops=function(){if(this.addDropCallback){this.addDropCallback()}for(var j=0;j<Math.floor(this.drops.length*Math.random()*0.4);++j){var h=this.drops[j];h.animate()}if(!this.drops.length){return}window.requestAnimationFrame(this.animateDrops.bind(this))};d.prototype.setRequestAnimFrame=function(){var h=this.options.fps;window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(i){window.setTimeout(i,1000/h)}})()};d.prototype.prepareReflections=function(){this.reflected=document.createElement("canvas");this.reflected.width=this.canvas.width/this.options.reflectionScaledownFactor;this.reflected.height=this.canvas.height/this.options.reflectionScaledownFactor;var h=this.reflected.getContext("2d");h.drawImage(this.img,this.options.crop[0],this.options.crop[1],this.options.crop[2],this.options.crop[3],0,0,this.reflected.width,this.reflected.height)};d.prototype.prepareGlass=function(){this.glass=document.createElement("canvas");this.glass.width=this.canvas.width;this.glass.height=this.canvas.height;this.context=this.glass.getContext("2d")};d.prototype.rain=function(j,n){var p=this;if(this.reflection!==this.REFLECTION_NONE){this.prepareReflections()}this.presets=j;this.PRIVATE_GRAVITY_FORCE_FACTOR_Y=(this.options.fps*0.001)/25;this.PRIVATE_GRAVITY_FORCE_FACTOR_X=((Math.PI/2)-this.options.gravityAngle)*(this.options.fps*0.001)/50;if(this.options.enableCollisions){var h=0;for(var l=0;l<j.length;l++){if(j[l][0]+j[l][1]>h){h=Math.floor(j[l][0]+j[l][1])}}if(h>0){var k=Math.ceil(this.canvas.width/h);var m=Math.ceil(this.canvas.height/h);this.matrix=new a(k,m,h)}else{this.options.enableCollisions=false}}for(var l=0;l<j.length;l++){if(!j[l][3]){j[l][3]=-1}}var o=0;this.addDropCallback=function(){var t=new Date().getTime();if(t-o<n){return}o=t;var r=this.canvas.getContext("2d");r.clearRect(0,0,this.canvas.width,this.canvas.height);r.drawImage(this.background,0,0,this.canvas.width,this.canvas.height);var s;for(var q=0;q<j.length;q++){if(j[q][2]>1||j[q][3]===-1){if(j[q][3]!==0){j[q][3]--;for(var u=0;u<j[q][2];++u){this.putDrop(new g(this,Math.random()*this.canvas.width,Math.random()*this.canvas.height,j[q][0],j[q][1]))}}}else{if(Math.random()<j[q][2]){s=j[q];break}}}if(s){this.putDrop(new g(this,Math.random()*this.canvas.width,Math.random()*this.canvas.height,s[0],s[1]))}r.save();r.globalAlpha=this.options.opacity;if(t-p.beginTime>20000){r.clearRect(this.glass,0,0,this.canvas.width,this.canvas.height);p.drops=[];p.beginTime=new Date().getTime();p.glass=null;p.prepareGlass();if(p.options.rainyEffect===1){p.rain([[0,2,10],[3,3,0.1]],33)}else{if(p.options.rainyEffect===0){p.rain([[3,2,2]],50)}}}else{r.drawImage(this.glass,0,0,this.canvas.width,this.canvas.height)}r.restore()}.bind(this);this.animateDrops()};d.prototype.putDrop=function(h){h.draw();if(this.gravity&&h.r>this.options.gravityThreshold){if(this.options.enableCollisions){this.matrix.update(h)}this.drops.push(h)}};d.prototype.clearDrop=function(i,k){var h=i.clear(k);if(h){var j=this.drops.indexOf(i);if(j>=0){this.drops.splice(j,1)}}return h};function g(l,k,j,h,i){this.x=Math.floor(k);this.y=Math.floor(j);this.r=(Math.random()*i)+h;this.rainyday=l;this.context=l.context;this.reflection=l.reflected}g.prototype.draw=function(){this.context.save();this.context.beginPath();var i=this.r;this.r=0.95*this.r;if(this.r<3){this.context.arc(this.x,this.y,this.r,0,Math.PI*2,true);this.context.closePath()}else{if(this.colliding||this.yspeed>2){if(this.colliding){var h=this.colliding;this.r=1.001*(this.r>h.r?this.r:h.r);this.x+=(h.x-this.x);this.colliding=null}var j=1+0.1*this.yspeed;this.context.moveTo(this.x-this.r/j,this.y);this.context.bezierCurveTo(this.x-this.r,this.y-this.r*2,this.x+this.r,this.y-this.r*2,this.x+this.r/j,this.y);this.context.bezierCurveTo(this.x+this.r,this.y+j*this.r,this.x-this.r,this.y+j*this.r,this.x-this.r/j,this.y)}else{this.context.arc(this.x,this.y,this.r*0.9,0,Math.PI*2,true);this.context.closePath()}}this.context.clip();this.r=i;if(this.rainyday.reflection){this.rainyday.reflection(this)}this.context.restore()};g.prototype.clear=function(h){this.context.clearRect(this.x-this.r-1,this.y-this.r-2,2*this.r+2,2*this.r+2);if(h){this.terminate=true;return true}if((this.y-this.r>this.rainyday.canvas.height)||(this.x-this.r>this.rainyday.canvas.width)||(this.x+this.r<0)){return true}return false};g.prototype.animate=function(){if(this.terminate){return false}var i=this.rainyday.gravity(this);if(!i&&this.rainyday.trail){this.rainyday.trail(this)}if(this.rainyday.options.enableCollisions){var h=this.rainyday.matrix.update(this,i);if(h){this.rainyday.collision(this,h)}}return !i||this.terminate};d.prototype.TRAIL_NONE=function(){};d.prototype.TRAIL_DROPS=function(h){if(!h.trailY||h.y-h.trailY>=Math.random()*100*h.r){h.trailY=h.y;this.putDrop(new g(this,h.x+(Math.random()*2-1)*Math.random(),h.y-h.r-5,Math.ceil(h.r/5),0))}};d.prototype.TRAIL_SMUDGE=function(i){var j=i.y-i.r-3;var h=i.x-i.r/2+(Math.random()*2);if(j<0||h<0){return}this.context.drawImage(this.clearbackground,h,j,i.r,2,h,j,i.r,2)};d.prototype.GRAVITY_NONE=function(){return true};d.prototype.GRAVITY_LINEAR=function(h){if(this.clearDrop(h)){return true}if(h.yspeed){h.yspeed+=this.PRIVATE_GRAVITY_FORCE_FACTOR_Y*Math.floor(h.r);h.xspeed+=this.PRIVATE_GRAVITY_FORCE_FACTOR_X*Math.floor(h.r)}else{h.yspeed=this.PRIVATE_GRAVITY_FORCE_FACTOR_Y;h.xspeed=this.PRIVATE_GRAVITY_FORCE_FACTOR_X}h.y+=h.yspeed;h.draw();return false};d.prototype.GRAVITY_NON_LINEAR=function(h){if(this.clearDrop(h)){return true}if(h.collided){h.collided=false;h.seed=Math.floor(h.r*Math.random()*this.options.fps);h.skipping=false;h.slowing=false}else{if(!h.seed||h.seed<0){h.seed=Math.floor(h.r*Math.random()*this.options.fps);h.skipping=h.skipping===false?true:false;h.slowing=true}}h.seed--;if(h.yspeed){if(h.slowing){h.yspeed/=1.1;h.xspeed/=1.1;if(h.yspeed<this.PRIVATE_GRAVITY_FORCE_FACTOR_Y){h.slowing=false}}else{if(h.skipping){h.yspeed=this.PRIVATE_GRAVITY_FORCE_FACTOR_Y;h.xspeed=this.PRIVATE_GRAVITY_FORCE_FACTOR_X}else{h.yspeed+=1*this.PRIVATE_GRAVITY_FORCE_FACTOR_Y*Math.floor(h.r);h.xspeed+=1*this.PRIVATE_GRAVITY_FORCE_FACTOR_X*Math.floor(h.r)}}}else{h.yspeed=this.PRIVATE_GRAVITY_FORCE_FACTOR_Y;h.xspeed=this.PRIVATE_GRAVITY_FORCE_FACTOR_X}if(this.options.gravityAngleVariance!==0){h.xspeed+=((Math.random()*2-1)*h.yspeed*this.options.gravityAngleVariance)}h.y+=h.yspeed;h.x+=h.xspeed;h.draw();return false};d.prototype.positiveMin=function(j,i){var h=0;if(j<i){if(j<=0){h=i}else{h=j}}else{if(i<=0){h=j}else{h=i}}return h<=0?1:h};d.prototype.REFLECTION_NONE=function(){this.context.fillStyle=this.options.fillStyle;this.context.fill()};d.prototype.REFLECTION_MINIATURE=function(k){var n=Math.max((k.x-this.options.reflectionDropMappingWidth)/this.options.reflectionScaledownFactor,0);var m=Math.max((k.y-this.options.reflectionDropMappingHeight)/this.options.reflectionScaledownFactor,0);var h=this.positiveMin(this.options.reflectionDropMappingWidth*2/this.options.reflectionScaledownFactor,this.reflected.width-n);var l=this.positiveMin(this.options.reflectionDropMappingHeight*2/this.options.reflectionScaledownFactor,this.reflected.height-m);var j=Math.max(k.x-1.1*k.r,0);var i=Math.max(k.y-1.1*k.r,0);this.context.drawImage(this.reflected,n,m,h,l,j,i,k.r*2,k.r*2)};d.prototype.COLLISION_SIMPLE=function(i,k){var l=k;var n;while(l!=null){var m=l.drop;if(Math.sqrt(Math.pow(i.x-m.x,2)+Math.pow(i.y-m.y,2))<(i.r+m.r)){n=m;break}l=l.next}if(!n){return}var h,j;if(i.y>n.y){h=i;j=n}else{h=n;j=i}this.clearDrop(j);this.clearDrop(h,true);this.matrix.remove(h);j.draw();j.colliding=h;j.collided=true};d.prototype.prepareBackground=function(){this.background=document.createElement("canvas");this.background.width=this.canvas.width;this.background.height=this.canvas.height;this.clearbackground=document.createElement("canvas");this.clearbackground.width=this.canvas.width;this.clearbackground.height=this.canvas.height;var h=this.background.getContext("2d");h.clearRect(0,0,this.canvas.width,this.canvas.height);h.drawImage(this.img,this.options.crop[0],this.options.crop[1],this.options.crop[2],this.options.crop[3],0,0,this.canvas.width,this.canvas.height);h=this.clearbackground.getContext("2d");h.clearRect(0,0,this.canvas.width,this.canvas.height);h.drawImage(this.img,this.options.crop[0],this.options.crop[1],this.options.crop[2],this.options.crop[3],0,0,this.canvas.width,this.canvas.height);if(!isNaN(this.options.blur)&&this.options.blur>=1){this.stackBlurCanvasRGB(this.canvas.width,this.canvas.height,this.options.blur)}};d.prototype.stackBlurCanvasRGB=function(h,k,O){var D=[[0,9],[1,11],[2,12],[3,13],[5,14],[7,15],[11,16],[15,17],[22,18],[31,19],[45,20],[63,21],[90,22],[127,23],[181,24]];var N=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];O|=0;var W=this.background.getContext("2d");if(h===0||k===0){return}var S=W.getImageData(0,0,h,k);var m=S.data;var M,L,U,R,u,A,s,T,v,t,K,J,I,l,z,Q,r,w,B,F;var o=O+1;var P=o*(o+1)/2;var E=new f();var q=new f();var C=E;for(U=1;U<2*O+1;U++){C=C.next=new f();if(U===o){q=C}}C.next=E;var V=null;var H=null;s=A=0;var G=N[O];var n;for(var j=0;j<D.length;++j){if(O<=D[j][0]){n=D[j-1][1];break}}for(L=0;L<k;L++){l=z=Q=T=v=t=0;K=o*(r=m[A]);J=o*(w=m[A+1]);I=o*(B=m[A+2]);T+=P*r;v+=P*w;t+=P*B;C=E;for(U=0;U<o;U++){C.r=r;C.g=w;C.b=B;C=C.next}for(U=1;U<o;U++){R=A+((h-1<U?h-1:U)<<2);T+=(C.r=(r=m[R]))*(F=o-U);v+=(C.g=(w=m[R+1]))*F;t+=(C.b=(B=m[R+2]))*F;l+=r;z+=w;Q+=B;C=C.next}V=E;H=q;for(M=0;M<h;M++){m[A]=(T*G)>>n;m[A+1]=(v*G)>>n;m[A+2]=(t*G)>>n;T-=K;v-=J;t-=I;K-=V.r;J-=V.g;I-=V.b;R=(s+((R=M+O+1)<(h-1)?R:(h-1)))<<2;l+=(V.r=m[R]);z+=(V.g=m[R+1]);Q+=(V.b=m[R+2]);T+=l;v+=z;t+=Q;V=V.next;K+=(r=H.r);J+=(w=H.g);I+=(B=H.b);l-=r;z-=w;Q-=B;H=H.next;A+=4}s+=h}for(M=0;M<h;M++){z=Q=l=v=t=T=0;A=M<<2;K=o*(r=m[A]);J=o*(w=m[A+1]);I=o*(B=m[A+2]);T+=P*r;v+=P*w;t+=P*B;C=E;for(U=0;U<o;U++){C.r=r;C.g=w;C.b=B;C=C.next}u=h;for(U=1;U<o;U++){A=(u+M)<<2;T+=(C.r=(r=m[A]))*(F=o-U);v+=(C.g=(w=m[A+1]))*F;t+=(C.b=(B=m[A+2]))*F;l+=r;z+=w;Q+=B;C=C.next;if(U<(k-1)){u+=h}}A=M;V=E;H=q;for(L=0;L<k;L++){R=A<<2;m[R]=(T*G)>>n;m[R+1]=(v*G)>>n;m[R+2]=(t*G)>>n;T-=K;v-=J;t-=I;K-=V.r;J-=V.g;I-=V.b;R=(M+(((R=L+o)<(k-1)?R:(k-1))*h))<<2;T+=(l+=(V.r=m[R]));v+=(z+=(V.g=m[R+1]));t+=(Q+=(V.b=m[R+2]));V=V.next;K+=(r=H.r);J+=(w=H.g);I+=(B=H.b);l-=r;z-=w;Q-=B;H=H.next;A+=h}}W.putImageData(S,0,0)};function f(){this.r=0;this.g=0;this.b=0;this.next=null}function a(h,n,m){this.resolution=m;this.xc=h;this.yc=n;this.matrix=new Array(h);for(var l=0;l<=(h+5);l++){this.matrix[l]=new Array(n);for(var k=0;k<=(n+5);++k){this.matrix[l][k]=new b(null)}}}a.prototype.update=function(i,h){if(i.gid){if(!this.matrix[i.gmx]||!this.matrix[i.gmx][i.gmy]){return null}this.matrix[i.gmx][i.gmy].remove(i);if(h){return null}i.gmx=Math.floor(i.x/this.resolution);i.gmy=Math.floor(i.y/this.resolution);if(!this.matrix[i.gmx]||!this.matrix[i.gmx][i.gmy]){return null}this.matrix[i.gmx][i.gmy].add(i);var j=this.collisions(i);if(j&&j.next!=null){return j.next}}else{i.gid=Math.random().toString(36).substr(2,9);i.gmx=Math.floor(i.x/this.resolution);i.gmy=Math.floor(i.y/this.resolution);if(!this.matrix[i.gmx]||!this.matrix[i.gmx][i.gmy]){return null}this.matrix[i.gmx][i.gmy].add(i)}return null};a.prototype.collisions=function(h){var i=new b(null);var j=i;i=this.addAll(i,h.gmx-1,h.gmy+1);i=this.addAll(i,h.gmx,h.gmy+1);i=this.addAll(i,h.gmx+1,h.gmy+1);return j};a.prototype.addAll=function(k,h,j){if(h>0&&j>0&&h<this.xc&&j<this.yc){var i=this.matrix[h][j];while(i.next!=null){i=i.next;k.next=new b(i.drop);k=k.next}}return k};a.prototype.remove=function(h){this.matrix[h.gmx][h.gmy].remove(h)};function b(h){this.drop=h;this.next=null}b.prototype.add=function(h){var i=this;while(i.next!=null){i=i.next}i.next=new b(h)};b.prototype.remove=function(i){var j=this;var h=null;while(j.next!=null){h=j;j=j.next;if(j.drop.gid===i.gid){h.next=j.next}}};e.fn.extend({faiRainyDay:function(h){var i=c();var h=h||{};i&&e(this).each(function(j,l){var k=new d(h,l);if(h.rainyEffect===0){k.rain([[3,2,2]],50)}else{if(h.rainyEffect===1){k.rain([[0,2,10],[3,3,0.1]],33)}}})}})})(jQuery);(function(g){var e;var h;var o;var b=[];var k=800;var p=[];var c=3;var i=[];var a=200;var r;var m;var l=function(){var s=document.createElement("canvas");return(typeof s.getContext)=="function"};function n(u,t){var v=g(u);var s=document.createElement("canvas");v.append(s);s.width=t.width||window.innerWidth;s.height=t.height||window.innerHeight;s.className="meteor-canvas";h=s.height;o=s.width;e=s.getContext("2d");e.fillStyle="black";if(o/c<100){a=100}}var d=function(){this.x=o*Math.random();this.y=5000*Math.random();this.text=".";this.color="white"};d.prototype={constructor:d,getColor:function(){var s=Math.random();if(s<0.5){this.color="gray"}else{this.color="white"}},init:function(){this.getColor()},draw:function(){e.beginPath();e.arc(this.x,this.y,0.05,0,2*Math.PI);e.strokeStyle=this.color;e.stroke();e.closePath()}};function q(){for(var s=0;s<k;s++){b[s].getColor();b[s].draw()}clearTimeout(m);m=setTimeout(q,200)}var f=function(){this.x=-1;this.y=-1;this.length=-1;this.angle=30;this.width=-1;this.height=-1;this.speed=1;this.offset_x=-1;this.offset_y=-1;this.alpha=1;this.color1="";this.color2=""};f.prototype={constructor:f,init:function(u){this.getPos(u);this.alpha=1;var s=Math.random()*80+180;this.length=Math.ceil(s);this.angle=30;s=Math.random()+0.5;this.speed=Math.ceil(s);var v=Math.cos(this.angle*3.14/180);var t=Math.sin(this.angle*3.14/180);this.width=this.length*v;this.height=this.length*t;this.offset_x=this.speed*v*3.5;this.offset_y=this.speed*t*3.5},countPos:function(){this.x=this.x-this.offset_x;this.y=this.y+this.offset_y},getPos:function(t){_this=this;function s(){_this.x=Math.random()*o;if(i.length){for(var u=0;u<i.length;u++){if(Math.abs(_this.x-i[u])<a){return s()}}}i[t]=_this.x}s();this.y=0.2*h},draw:function(){e.save();e.beginPath();e.lineWidth=2.5;e.globalAlpha=this.alpha;var s=e.createLinearGradient(this.x,this.y,this.x+this.width,this.y-this.height);s.addColorStop(0,"rgba(255, 255, 255, 1)");s.addColorStop(1,"rgba(255, 255,255 , 0)");if(this.alpha<0){this.alpha=-this.alpha}e.strokeStyle=s;e.moveTo(this.x,this.y);e.lineTo(this.x+this.width,this.y-this.height);e.closePath();e.stroke();e.restore()},move:function(){var s=this.x+this.width-this.offset_x;var t=this.y-this.height;this.alpha-=0.002;this.countPos();if(this.alpha<=0){this.alpha=0}else{if(this.alpha>1){this.alpha=1}}e.clearRect(this.x-this.offset_x,t,this.width+this.offset_x,this.height);this.draw()}};function j(){for(var t=0;t<c;t++){var s=p[t];s.move();if(s.y>h+100){e.clearRect(s.x,s.y-s.height,s.width,s.height);i[t]=0;p[t]=new f(t);p[t].init(t)}}clearTimeout(r);r=setTimeout(j,10)}g.fn.extend({faiMeteor:function(s){var t=l();var s=s||{};b=[];p=[];t&&g(this).each(function(u,x){n(x,s);for(var u=0;u<k;u++){var w=new d();w.init();w.draw();b.push(w)}for(var u=0;u<c;u++){var v=new f(u);v.init(u);v.draw();p.push(v)}q();j()})}})})(jQuery);(function(f){var e=function(){var g=document.createElement("canvas");return(typeof g.getContext)=="function"};var d=function(h,g){return ~~((Math.random()*(g-h+1))+h)};var a=function(k,n,h,m,i,l,g,j){return !(k+h<i||i+g<k||n+m<l||l+j<n)};var c=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(g){window.setTimeout(g,1000/60)}})();var b=function(h,g){this.canvas=document.createElement("canvas");this.canvas.width=this.cw=g.width||f(window).innerWidth();this.canvas.height=this.ch=g.height||f(window).innerHeight();this.particles=[];this.partCount=150;this.fireworks=[];this.mx=this.cw/2;this.my=this.ch/2;this.currentHue=30;this.partSpeed=5;this.partSpeedVariance=10;this.partWind=50;this.partFriction=5;this.partGravity=1;this.hueMin=0;this.hueMax=360;this.fworkSpeed=4;this.fworkAccel=10;this.hueVariance=30;this.flickerDensity=25;this.showShockwave=true;this.showTarget=false;this.clearAlpha=25;f(h).append(this.canvas);this.canvas.className="fireworks-canvas";this.ctx=this.canvas.getContext("2d");this.ctx.lineCap="round";this.ctx.lineJoin="round";this.lineWidth=1;this.bindEvents();this.canvasLoop()};b.prototype={constructor:b,createParticles:function(g,k,h){var j=this.partCount;while(j--){var i={x:g,y:k,coordLast:[{x:g,y:k},{x:g,y:k},{x:g,y:k}],angle:d(0,360),speed:d(((this.partSpeed-this.partSpeedVariance)<=0)?1:this.partSpeed-this.partSpeedVariance,(this.partSpeed+this.partSpeedVariance)),friction:1-this.partFriction/100,gravity:this.partGravity/2,hue:d(h-this.hueVariance,h+this.hueVariance),brightness:d(50,80),alpha:d(40,100)/100,decay:d(10,50)/1000,wind:(d(0,this.partWind)-(this.partWind/2))/25,lineWidth:this.lineWidth};this.particles.push(i)}},updateParticles:function(){var h=this.particles.length;while(h--){var l=this.particles[h];var k=l.angle*Math.PI/180;var j=Math.cos(k)*l.speed;var g=Math.sin(k)*l.speed;l.speed*=l.friction;l.coordLast[2].x=l.coordLast[1].x;l.coordLast[2].y=l.coordLast[1].y;l.coordLast[1].x=l.coordLast[0].x;l.coordLast[1].y=l.coordLast[0].y;l.coordLast[0].x=l.x;l.coordLast[0].y=l.y;l.x+=j;l.y+=g;l.y+=l.gravity;l.angle+=l.wind;l.alpha-=l.decay;if(!a(0,0,this.cw,this.ch,l.x-l.radius,l.y-l.radius,l.radius*2,l.radius*2)||l.alpha<0.05){this.particles.splice(h,1)}}},drawParticles:function(){var k=this.particles.length;while(k--){var l=this.particles[k];var h=(d(1,3)-1);this.ctx.beginPath();this.ctx.moveTo(Math.round(l.coordLast[h].x),Math.round(l.coordLast[h].y));this.ctx.lineTo(Math.round(l.x),Math.round(l.y));this.ctx.closePath();this.ctx.strokeStyle="hsla("+l.hue+", 100%, "+l.brightness+"%, "+l.alpha+")";this.ctx.stroke();if(this.flickerDensity>0){var j=50-this.flickerDensity;if(d(0,j)===j){this.ctx.beginPath();this.ctx.arc(Math.round(l.x),Math.round(l.y),d(l.lineWidth,l.lineWidth+3)/2,0,Math.PI*2,false);this.ctx.closePath();var g=d(50,100)/100;this.ctx.fillStyle="hsla("+l.hue+", 100%, "+l.brightness+"%, "+g+")";this.ctx.fill()}}}},createFireworks:function(i,h,k,j){var g={x:i,y:h,startX:i,startY:h,hitX:false,hitY:false,coordLast:[{x:i,y:h},{x:i,y:h},{x:i,y:h}],targetX:k,targetY:j,speed:this.fworkSpeed,angle:Math.atan2(j-h,k-i),shockwaveAngle:Math.atan2(j-h,k-i)+(90*(Math.PI/180)),acceleration:this.fworkAccel/100,hue:this.currentHue,brightness:d(50,80),alpha:d(50,100)/100,lineWidth:this.lineWidth};this.fireworks.push(g)},updateFireworks:function(){var g=this.fireworks.length;while(g--){var h=this.fireworks[g];this.ctx.lineWidth=h.lineWidth;vx=Math.cos(h.angle)*h.speed,vy=Math.sin(h.angle)*h.speed;h.speed*=1+h.acceleration;h.coordLast[2].x=h.coordLast[1].x;h.coordLast[2].y=h.coordLast[1].y;h.coordLast[1].x=h.coordLast[0].x;h.coordLast[1].y=h.coordLast[0].y;h.coordLast[0].x=h.x;h.coordLast[0].y=h.y;if(h.startX>=h.targetX){if(h.x+vx<=h.targetX){h.x=h.targetX;h.hitX=true}else{h.x+=vx}}else{if(h.x+vx>=h.targetX){h.x=h.targetX;h.hitX=true}else{h.x+=vx}}if(h.startY>=h.targetY){if(h.y+vy<=h.targetY){h.y=h.targetY;h.hitY=true}else{h.y+=vy}}else{if(h.y+vy>=h.targetY){h.y=h.targetY;h.hitY=true}else{h.y+=vy}}if(h.hitX&&h.hitY){this.createParticles(h.targetX,h.targetY,h.hue);this.fireworks.splice(g,1)}}},drawFireworks:function(){var h=this.fireworks.length;this.ctx.globalCompositeOperation="lighter";while(h--){var j=this.fireworks[h];this.ctx.lineWidth=j.lineWidth;var g=(d(1,3)-1);this.ctx.beginPath();this.ctx.moveTo(Math.round(j.coordLast[g].x),Math.round(j.coordLast[g].y));this.ctx.lineTo(Math.round(j.x),Math.round(j.y));this.ctx.closePath();this.ctx.strokeStyle="hsla("+j.hue+", 100%, "+j.brightness+"%, "+j.alpha+")";this.ctx.stroke();if(this.showTarget){this.ctx.save();this.ctx.beginPath();this.ctx.arc(Math.round(j.targetX),Math.round(j.targetY),d(1,8),0,Math.PI*2,false);this.ctx.closePath();this.ctx.lineWidth=1;this.ctx.stroke();this.ctx.restore()}if(this.showShockwave){this.ctx.save();this.ctx.translate(Math.round(j.x),Math.round(j.y));this.ctx.rotate(j.shockwaveAngle);this.ctx.beginPath();this.ctx.arc(0,0,1*(j.speed/5),0,Math.PI,true);this.ctx.strokeStyle="hsla("+j.hue+", 100%, "+j.brightness+"%, "+d(25,60)/100+")";this.ctx.lineWidth=j.lineWidth;this.ctx.stroke();this.ctx.restore()}}},bindEvents:function(){var i=this;var g;function h(){i.mx=i.canvas.width*Math.random()-i.canvas.offsetLeft;i.my=i.canvas.height*Math.random()-i.canvas.offsetTop;i.currentHue=d(i.hueMin,i.hueMax);i.createFireworks(i.cw/2,i.ch,i.mx,i.my);setTimeout(function(){c(h.bind(i))},500)}i.clear();c(h.bind(i))},clear:function(){this.particles=[];this.fireworks=[];this.ctx.clearRect(0,0,this.cw,this.ch)},canvasLoop:function(){var g=this;c(this.canvasLoop.bind(g),this.canvas);this.ctx.globalCompositeOperation="destination-out";this.ctx.fillStyle="rgba(0, 0, 0, "+this.clearAlpha/100+")";this.ctx.fillRect(0,0,this.cw,this.ch);this.updateFireworks();this.updateParticles();this.drawFireworks();this.drawParticles()}};f.fn.extend({faiFireworks:function(g){var h=e();var g=g||{};h&&f(this).each(function(j,k){new b(k,g)})}})})(jQuery);