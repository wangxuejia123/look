(function(i,v,k){i.fn.faiColorPickerAlp=function(K){var J={base:this,target:this,baseattr:"background-color",targetattr:"background-color",col1:["#FCC02E","#FED835","#FFEB3C","#FFF176","#FFF59C","origin"],col2:["#F67C01","#FB8C00","#FFA727","#FFB74E","#FFCC80","#FFFFFF"],col3:["#E64A19","#F5511E","#FE5722","#FF8A66","#FFAB91","#DEDEDE"],col4:["#D81B43","#EB1D4E","#EB4165","#F1627E","#FB879E","#A9A9A9"],col5:["#8E24AA","#9C28B1","#AA47BC","#B968C7","#CF93D9","#4B4B4B"],col6:["#512DA7","#5D35B0","#673BB7","#7986CC","#9EA8DB","#353535"],col7:["#1F87E8","#2097F3","#42A5F6","#64B5F6","#90CAF8","#212121"],col8:["#008781","#029688","#26A59A","#80CBC4","#B2DFDC","#000000"],col9:["#05A045","#4CB050","#83C683","#A5D6A7","#C8E6CA","advance"],advance:true,showInTop:false,appendToWeb:false,showStatus:0,onShowStatus:i.noop,onchange:i.noop,changeStop:i.noop,inputHexStatus:i.noop,top:0,left:0,moduleId:0,_top:0,_left:0,hideAfterSet:false,__top:0,__left:0,noAlpha:false,_onclick:i.noop};K=i.extend({},J,K);if(K.showInTop){K.$$=Fai.top.$}else{K.$$=i}K.base.bind("click",B(K))};function x(){if(window.WXApp){return true}if(Fai.isIE6()||Fai.isIE7()||Fai.isIE8()){return false}return true}function B(M){var L=M.$$,Q=window.event||L.event;if(Q.stopPropagation){Q.stopPropagation()}else{if(window.event){window.event.cancelBubble=true}}L(".J_faiColorPickerAlp").remove();L(".J_advanceColorPicker").remove();var O=(function(){var U=(function(){var V=[],W;for(W=1;W<10;W++){V.push(M["col"+W])}return V})(),T=M.advance,R=I(),S=M.target.css(M.targetattr)||"transparent";return G(U,T,R,S,M.noAlpha)})();if(window.WXApp){M.appendToWeb=false}L(M.appendToWeb?"#web":"body").append(O);var K={top:"",left:"",width:"225px","z-index":9999};i.extend(K,H(M));var J=I().length>0?"235":"190";J=M.noAlpha?J-35:J;J=J+"px";L(".J_faiColorPickerAlp").css(K).show().animate({height:J});L(".J_faiColorPickerAlp").click(function(R){R.stopPropagation()});L(".J_faiColorPickerAlp").find("#faiColorPicker-hidden").focus();var P="",N=navigator.userAgent.toLowerCase();if(/msie/.test(N)){P="-ms-"}else{if(/chrome/.test(N)||/safari/.test(N)||/yandex/.test(N)){P="-webkit-"}else{if(/mozilla/.test(N)){P="-moz-"}else{if(/opera/.test(N)){P="-o-"}else{if(/konqueror/.test(N)){P="-khtml-"}else{P=""}}}}}L(".J_faiColorPickerAlp").css(P+"user-select","none").addClass("unselectable").attr("unselectable","on").on("selectstart mousedown",false);M.showStatus=1;f(M)}function G(P,O,K,N,M){var L=[],J=Math.floor(Math.random()*1000);L.push('<div class="J_faiColorPickerAlp fk-colorPickerAlp" id="faiColorPicker'+J+'">');(function(){var R,Q,S;L.push('<div class="fk-colorPicker-colorcol J_colorPicker_colorcol">');for(R=0;R<P.length;R++){L.push('<div class="col">');for(Q=0,S=P[R];Q<S.length;Q++){if(S[Q]=="origin"){L.push('<div class="J_original_clear f-original-clear" title="透明颜色"></div>')}else{if(O&&S[Q]=="advance"){L.push('<div class="J_coloradvance_btn f-coloradvance-btn"></div>')}else{L.push('<div class="col-color J_colorPicker_normal">');L.push('<div style="background-color:'+S[Q]+'"></div>');L.push("</div>")}}}L.push("</div>")}L.push("</div>")})();(function(){var Q=K.length,R;if(Q!=0){L.push('<div class="fk-colorPicker-recent J_colorPicker_colorcol">');for(R=0;R<Q;R++){L.push('<div class="col-color J_colorPicker_normal">');L.push('<div style="background-color:'+K[R]+'"></div>');L.push("</div>")}L.push("</div>")}})();if(!M){(function(){var Q=n(N)?"linear-gradient(to right, rgba(0,0,0,0), rgba(0,0,0,0))":("linear-gradient(to right, "+C(N)+", rgba(0,0,0,0))"),Q=Q||"linear-gradient(to right, rgb(255, 255, 255), rgba(255, 255, 255, 0))",Q=(i.browser.msie&&i.browser.version=="9.0")?"filter: progid:DXImageTransform.Microsoft.gradient(GradientType='1', startColorstr='"+r(N)+"', endColorstr='#ffffff')":"background: "+Q;alp=q(N),spAlphaHandleLeft=168*(1-alp);L.push('<div class="fk-colorPicker-clearcolor">');L.push('<div class="f-original-color-bg">');L.push('<div class="J_original_color f-original-color" style="background-color:'+N+';"></div>');L.push("</div>");L.push('<div class="J_sp_alpha fk-sp-alpha">');L.push('<div class="J_sp_alpha_inner fk-sp-alpha-inner" style="'+Q+';">');L.push('<div class="J_sp_alpha_handle fk-sp-alpha-handle" style="left: '+spAlphaHandleLeft+'px;"></div>');L.push("</div>");L.push("</div>");L.push("</div>")})()}L.push("</div>");return L.join("")}function H(M){var Y,N,V=M.$$;if(M.showInTop){var P=V(".formDialog");$$popupwindow=P.length>0?P:V(".fk-popupWindowVT");if($$popupwindow.offset()){var T=$$popupwindow.last().offset();N=M.left+T.left+M.base.offset().left+M.base.width()/2-12;Y=M.top+T.top+M.base.offset().top+M.base.height()/2+27}else{N=M.left+M.base.offset().left+M.base.width()/2-12;Y=M.top+M.base.offset().top+M.base.height()/2+15}}else{if(M.moduleId!=0){N=M.left+M.base.offset().left+M.base.width()/2-12;Y=M.top+M.base.offset().top+M.base.height()/2-22;N=N-206-50;var J=(M.appendToWeb||!M.isSystemModule)?i("#module"+M.moduleId):i("#"+M.moduleId),L=J.width(),K=J.height(),O=J.offset().top,Z=i(M.base).parent().width(),X=i(M.base).parent().offset().top-(M.appendToWeb?V("#web").offset().top:0),U=i(M.base).parent().offset().left,W=K+(O-X),aa=i(window).width(),S=i(window).height(),Q=i(M.base).parent().offset().top+i("#g_main").scrollTop()+255-V("#web").height();if(250>U&&(U+L+250)<=aa){if(M.appendToWeb){Y=Q>0?(X-Q):X}else{if(255+X>S){Y=X-(S-255)}else{Y=X}}var R=5;if(i(M.base).hasClass("border-tool-icon")||i(M.base).hasClass("shadow-tool-icon")){R=30}if(L>Z){N=U+L+R}else{N=U+Z+R}}else{if(250<U){if(M.appendToWeb){Y=Q>0?(X-Q):X}else{if(255+X>S){Y=S-255}else{Y=X}}N=U-250;N+=M.__left;Y+=M.__top}else{if(M.appendToWeb){Y=Q>0?(X-Q):X}else{if(255+X>S){Y=S-255}else{Y=X}}if(L>Z){N=U+(L-250)/2}else{N=U+(Z-250)/2}}}}else{N=M.left+M.base.offset().left+M.base.width()/2-12;Y=M.top+M.base.offset().top+M.base.height()/2-22;N=N-206-50;if(window===Fai.top&&!window.WXApp){Y=Y-Fai.top.$("#g_main").offset().top+Fai.top.$("#g_main").scrollTop()+27+10+5;N=N+Fai.top.$("#g_main").scrollLeft();N=N<0?0:N}}}return{top:Y,left:N}}function f(M){var K=M.$$,L=K(".J_faiColorPickerAlp"),N=M.target.css(M.targetattr)||"transparent";M.originalColor=N;M.elm=M.target;L.off(".cpa").on("click.cpa",".J_colorPicker_normal",M,u).on("mouseenter.cpa",".J_colorPicker_normal",M,y).on("mouseleave.cpa",".J_colorPicker_normal, .J_original_clear",M,o).on("click.cpa",".J_original_clear",M,z).on("mouseenter.cpa",".J_original_clear",M,F).on("click.cpa",".J_coloradvance_btn",M,g).on("touchstart.cpa mousedown.cpa",".J_sp_alpha",M,a);if(M.hideAfterSet){L.on("click.cpa",".J_colorPicker_normal, .J_original_clear",M,j)}M.target.siblings(".tool").one("click",j);K("body").unbind("click",j).bind("click",{$$:K,elm:M.target,targetattr:M.targetattr,onchange:M.onchange,showStatus:M.showStatus,onShowStatus:M.onShowStatus,changeStop:M.changeStop,originalColor:M.originalColor,noAlpha:M.noAlpha},j);Fai.top.$("body").unbind("click",j).bind("click",{$$:K,elm:M.target,targetattr:M.targetattr,onchange:M.onchange,showStatus:M.showStatus,onShowStatus:M.onShowStatus,changeStop:M.changeStop,originalColor:M.originalColor,noAlpha:M.noAlpha},j);if(M.showInTop){i("body").unbind("click",j).bind("click",{$$:K,elm:M.target,targetattr:M.targetattr,onchange:M.onchange,changeStop:M.changeStop,originalColor:M.originalColor,noAlpha:M.noAlpha},j);var J=K(".faiColorPicker");J.mouseout(function(){J.attr("mouseIn",0)}).mouseover(function(){J.attr("mouseIn",1)}).focusout(function(){if(J.attr("mouseIn")==1){J.find("#faiColorPicker-hidden").focus();return}J.remove()})}}function u(L){var M=L.data,K=M.$$,J=K(this).find("div").css("background-color");J=M.noAlpha?r(J):q(J)==1?C(J):J;c(K,false,J);e(K,false,J);K(".J_colorPicker_normal").removeClass("current-col-color J_current_col_color");i(this).addClass("current-col-color J_current_col_color");M.onchange.call(M.elm,J);s(J);K(".J_faiColorPickerAlp").removeData("originalAlp").removeData("hasReset");if(M.noAlpha){M._onclick.call(M.elm);K(".J_faiColorPickerAlp").remove()}}function z(K){var L=K.data,J=L.$$;K.stopPropagation();c(J,true);J(".J_colorPicker_normal").removeClass("current-col-color J_current_col_color");J(".J_faiColorPickerAlp").data("hasReset",true);L.onchange.apply(L.elm,["transparent","transparent"]);if(L.noAlpha){J(".J_faiColorPickerAlp").remove()}}function F(K){var J=K.data.$$;c(J,true);e(J,true);h(J,1)}function y(M){var N=M.data,L=N.$$,K=i(this).find("div").css("background-color");c(L,false,K);e(L,false,K);var J=q(K);h(L,J);K=N.noAlpha?r(K):J==1?C(K):K;N.onchange.call(N.elm,K)}function o(M){var N=M.data,L=N.$$,K=E(M),J=b(M);if(n(J)){c(L,true);e(L,true);h(L,1)}else{c(L,false,J);e(L,false,J);h(L,K)}J=N.noAlpha?r(J):K==1?C(J):J;M.data.onchange.call(N.elm,J)}function j(L){L.stopPropagation&&L.stopPropagation();Fai.top.$("body").unbind("click",j);var K=L.data.$$;if(K(".J_faiColorPickerAlp").length<1){return}var J=b(L);J=L.data.noAlpha?r(J):q(J)==1?C(J):J;if(L.data.originalColor!==J){L.data.changeStop(J,L.data.originalColor)}K(".J_faiColorPickerAlp").remove();if(typeof L.data.showStatus){return}L.data.onShowStatus(L.data.showStatus);setTimeout(function(){L.data.showStatus=0},300)}function b(N){var O=N.data,L=O.$$,M=L(".J_faiColorPickerAlp"),K=L(".J_current_col_color").find("div").css(O.targetattr)||O.originalColor,J=E(N);return M.data("hasReset")?"transparent":K=="transparent"?"transparent":A(K,J)}function E(M){var N=M.data,K=N.$$,J=K(".J_current_col_color").find("div").css(N.targetattr)||N.originalColor;var L=K(".J_faiColorPickerAlp").data("originalAlp");return L==void 0?q(J):L}function g(O){O.stopPropagation();var K=O.data.$$,J=O.data.elm.css(O.data.targetattr);if(!O.data.noAlpha){O.data.inputHexStatus("1",J)}var P=K(".J_faiColorPickerAlp").offset().top,N=K(".J_faiColorPickerAlp").offset().left;if(O.data.appendToWeb){P=parseInt(K(".J_faiColorPickerAlp").css("top")),N=parseInt(K(".J_faiColorPickerAlp").css("left"))}K(".J_faiColorPickerAlp").remove();K(".J_advanceColorPicker").remove();K(O.data.appendToWeb?"#web":"body").append("<div class='J_advanceColorPicker'></div>");if(n(J)){J="FFFFFF"}else{J=r(J)}K(".J_advanceColorPicker").faiColorPickerAdven({flat:true,color:J,onHide:function(Q){Fai.top.$("body").unbind("click",j);K("body").unbind("click",j);i("body").unbind("click",j);K(".J_advanceColorPicker").hide();setTimeout(function(){K(".J_advanceColorPicker").remove()},500);return false},onShow:function(Q){return false},inputHexChange:function(Q,R){O.data.inputHexStatus(Q,"#"+R)},onChange:function(Q,S,R,T){O.data.onchange("#"+S);if(!T){s("#"+S)}O.stopPropagation()}});if(O.data.appendToWeb){K(".J_colorPickerAdven").css({top:P,left:N,})}else{K(".J_colorPickerAdven").css({top:P+O.data._top,left:N+O.data._left})}K(".J_advanceColorPicker").data("open",true);var M="",L=navigator.userAgent.toLowerCase();if(/msie/.test(L)){M="-ms-"}else{if(/chrome/.test(L)||/safari/.test(L)||/yandex/.test(L)){M="-webkit-"}else{if(/mozilla/.test(L)){M="-moz-"}else{if(/opera/.test(L)){M="-o-"}else{if(/konqueror/.test(L)){M="-khtml-"}else{M=""}}}}}K(".J_colorpicker_color,.J_colorpicker_brt,.J_colorpicker_hex label").css(M+"user-select","none").addClass("unselectable").attr("unselectable","on").on("selectstart mousedown",false);K(".J_colorpicker_back").off("click.back").on("click.back",function(Q){B(O.data);Q.stopPropagation()})}function a(W,K,R,L){var ac=W.data.elm.css(W.data.targetattr);if(n(ac)){return}W.stopPropagation();var P=W.data.$$,J=P(this),W=W,Z=W.data.onchange,O=W.data.elm,ab=W.data.targetattr,K=K||function(){},R=R||function(){},L=L||function(){},ad=document,T=false,M={},U=0,Y=0;var aa={};aa.selectstart=Q,aa.dragstart=Q,aa["touchmove mousemove"]=S,aa["touchend mouseup"]=V;var X=(W.which)?(W.which==3):(W.button==2);var N=P(".J_faiColorPickerAlp");if(!X&&!T){if(R.apply(J,arguments)!==false){T=true;U=i(J).height();Y=i(J).width()-12;M=i(J).offset();N.bind(aa);i(ad.body).addClass("sp-dragging");S(W);Q(W)}}function Q(ae){if(ae.stopPropagation){ae.stopPropagation()}if(ae.preventDefault){ae.preventDefault()}ae.returnValue=false}function S(ai){if(T){var ah=ai.originalEvent&&ai.originalEvent.touches&&ai.originalEvent.touches[0],ag=ah&&ah.pageX||ai.pageX,ae=ah&&ah.pageY||ai.pageY,am=Math.max(0,Math.min(ag-M.left,Y)),al=Math.max(0,Math.min(ae-M.top,U));J.find(".J_sp_alpha_handle").css({left:am+"px"});var aj=(168-J.find(".J_sp_alpha_handle").position().left)/168;aj=aj<0?0:aj;var af=N.find(".J_original_color").css("background-color");if(i.browser.mozilla){af=n(af)?ac:af}af=A(af,aj);N.find(".J_original_color").css("background-color",af);var ak=W.data.noAlpha?r(C(af)):x()?af:C(af);Z.apply(O,[ak,af])}}function V(){if(T){i(ad).unbind(aa);i(ad.body).removeClass("sp-dragging");setTimeout(function(){L.apply(J,arguments)},0)}T=false;var ae=(168-J.find(".J_sp_alpha_handle").position().left)/168;ae=ae<0?0:ae;var af=A(P(".J_original_color").css("background-color"),ae);af=ae==1?C(af):af;P(".J_faiColorPickerAlp ").data("originalAlp",ae);if(ae!=1&&x()){s(af)}}}function c(K,L,J){J=L?"transparent":J;K(".J_original_color").css("background-color",J)}function e(K,L,J){J=L?"transparent":C(J);if(i.browser.msie&&i.browser.version=="9.0"){K(".J_sp_alpha_inner").css("filter","progid:DXImageTransform.Microsoft.gradient(GradientType='1', startColorstr='"+r(J)+"', endColorstr='#ffffff')")}else{K(".J_sp_alpha_inner").css("background","linear-gradient(to right, "+J+", rgba(0,0,0,0))")}}function h(K,J){K(".J_sp_alpha_handle").css("left",168*(1-J)+"px")}var p=window.localStorage&&window.localStorage.setItem,D=window.localStorage&&window.localStorage.getItem,m=function(){},d=function(){};if(D){m=function(J){return window.localStorage.getItem(J)}}if(p){d=function(J,K){return window.localStorage.setItem(J,K)}}function I(){if(m("faiColorPickerAlp")==null){return""}else{var J=JSON.parse(m("faiColorPickerAlp"));return J}}function s(J){if(m("faiColorPickerAlp")==null){var L=new Array(J);d("faiColorPickerAlp",JSON.stringify(L))}else{var L=JSON.parse(m("faiColorPickerAlp"));for(var K=0;K<L.length;K++){if(L[K]==J){return}}if(L.length==9){L.pop();L.unshift(J);d("faiColorPickerAlp",JSON.stringify(L))}else{L.unshift(J);d("faiColorPickerAlp",JSON.stringify(L))}}}function r(J){if(!J){return""}if(/#/g.test(J)){return J}J=(J.replace(/[rgba\(\)]/g,"")).split(",");var M=["#"];for(var K=0,L;K<3;K++){L=parseInt(J[K]).toString(16);if(L.length===1){L="0"+L}M.push(L)}return M.join("")}function w(K){if(/rgb/gi.test(K)){return K}K=parseInt(K.substring(1),16);var J=["rgb(",K>>16,",",(K&65280)>>8,",",(K&255),")"];return J.join("")}function t(L,J){if(/rgba/gi.test(L)){return L}var J=J||0;L=parseInt(L.substring(1),16);var K=["rgba(",L>>16,",",(L&65280)>>8,",",(L&255),",",J,")"];return K.join("")}function A(K,J){var J=J||0;return t(r(K),J)}function C(L){if(!L){return""}if(n(L)){return"transparent"}if(/#/g.test(L)){return L}var K=L.split("(")[1].split(")")[0].split(",");var N=K[0],M=K[1],J=K[2];return"rgb("+N+","+M+","+J+")"}function n(J){if(!!J&&J.replace(/\s/g,"")=="rgba(0,0,0,0)"||J=="transparent"){return true}return false}function l(J){if(/rgba/gi.test(J)){return true}return false}function q(L){if(l(L)){var J=L.split("(")[1].split(")")[0].split(","),K=J[3];return K}else{return 1}}})(jQuery);(function(b){var a=function(){var X={},c,R=65,y,T='<div class="J_colorPickerAdven fk-colorPickerAdven"><div class="J_colorpicker_color fk-colorpicker-color"><div><div></div></div></div><div class="J_colorpicker_back fk-colorpicker-back"></div><div class="J_colorpicker_brt fk-colorpicker-brt"><div></div></div><div style="display:none;" class="J_colorpicker_new_color fk-colorpicker-new-color"></div><div style="display:none;" class="J_colorpicker_current_color fk-colorpicker-current-color"></div><div class="J_colorpicker_hex fk-colorpicker-hex"><label>输入色值#</label><input type="text" maxlength="6" size="6"/></div><div style="display:none;" class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div style="display:none;" class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div style="display:none;" class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div style="display:none;" class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div style="display:none;" class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div style="display:none;" class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="J_colorpicker_submit"></div></div>',F={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},inputHexFocus:function(){},inputHexChange:function(){},inputHexBlur:function(){},color:"ff0000",livePreview:true,flat:false},N=function(Y,aa){var Z=m(Y);b(aa).data("colorpicker").fields.eq(1).val(Z.r).end().eq(2).val(Z.g).end().eq(3).val(Z.b).end()},z=function(Y,Z){b(Z).data("colorpicker").fields.eq(4).val(Y.h).end().eq(5).val(Y.s).end().eq(6).val(Y.b).end()},h=function(Y,Z){b(Z).data("colorpicker").fields.eq(0).val(W(Y)).end()},o=function(Y,Z){b(Z).data("colorpicker").fields.eq(0).val((Y.indexOf("#")>-1)?Y.substring(1):Y).end()},p=function(Z,aa){var Y=n(Z);b(aa).data("colorpicker").selectorIndic.css({left:Y.left,top:Y.top})},r=function(Y,Z){b(Z).data("colorpicker").brt.parent().css("backgroundColor","#"+W({h:Y.h,s:Y.s,b:100}));b(Z).data("colorpicker").brt.css("left",parseInt(173-164*Y.b/100,10))},k=function(Y,Z){b(Z).data("colorpicker").currentColor.css("backgroundColor","#"+W(Y))},J=function(Y,Z){b(Z).data("colorpicker").newColor.css("backgroundColor","#"+W(Y))},t=function(Y){Y.stopPropagation()},q=function(ac){ac.stopPropagation();var ae=ac.charCode||ac.keyCode||-1;if(ae==17){return}if((ae<48||ae>57)&&(ae<65||ae>70)&&(ae<96||ae>105)&&ae!=8){b(this).val(this.value.replace(/[^0-9^a-f^A-F]/g,""))}var ad=b(this).parent().parent(),aa;var ab="";if(ad.data("colorpicker").livePreview===true){var Y=s(C(this.value));var Z=d(C(this.value));ad.data("colorpicker").fields.eq(1).val(Z.r).end().eq(2).val(Z.g).end().eq(3).val(Z.b).end().eq(4).val(Y.h).end().eq(5).val(Y.s).end().eq(6).val(Y.b);if(this.parentNode.className.indexOf("_hex")>0){ab=C(this.value);ad.data("colorpicker").color=aa=s(C(this.value))}else{if(this.parentNode.className.indexOf("_hsb")>0){ad.data("colorpicker").color=aa=g({h:parseInt(ad.data("colorpicker").fields.eq(4).val(),10),s:parseInt(ad.data("colorpicker").fields.eq(5).val(),10),b:parseInt(ad.data("colorpicker").fields.eq(6).val(),10)})}else{ad.data("colorpicker").color=aa=l(P({r:parseInt(ad.data("colorpicker").fields.eq(1).val(),10),g:parseInt(ad.data("colorpicker").fields.eq(2).val(),10),b:parseInt(ad.data("colorpicker").fields.eq(3).val(),10)}))}}if(ac&&!ab){N(aa,ad.get(0));h(aa,ad.get(0));z(aa,ad.get(0))}p(aa,ad.get(0));r(aa,ad.get(0));J(aa,ad.get(0));ab=ab?ab:W(aa);ad.data("colorpicker").inputHexChange.apply(ad,["2",ab])}},f=function(aa,ac){var ab=b(this).parent().parent(),Y;var Z="";if(this.parentNode.className.indexOf("_hex")>0){Z=C(this.value);ab.data("colorpicker").color=Y=s(C(this.value))}else{if(this.parentNode.className.indexOf("_hsb")>0){ab.data("colorpicker").color=Y=g({h:parseInt(ab.data("colorpicker").fields.eq(4).val(),10),s:parseInt(ab.data("colorpicker").fields.eq(5).val(),10),b:parseInt(ab.data("colorpicker").fields.eq(6).val(),10)})}else{ab.data("colorpicker").color=Y=l(P({r:parseInt(ab.data("colorpicker").fields.eq(1).val(),10),g:parseInt(ab.data("colorpicker").fields.eq(2).val(),10),b:parseInt(ab.data("colorpicker").fields.eq(3).val(),10)}))}}if(aa&&!Z){N(Y,ab.get(0));h(Y,ab.get(0));z(Y,ab.get(0))}p(Y,ab.get(0));r(Y,ab.get(0));J(Y,ab.get(0));Z=Z?Z:W(Y);ab.data("colorpicker").onChange.apply(ab,[Y,Z,m(Y),ac])},u=function(aa){var ab=b(this).parent().parent(),Y;ab.data("colorpicker").fields.parent().removeClass("fk-colorpicker-focus");var Z="";if(this.parentNode.className.indexOf("_hex")>0){Z=C(this.value);ab.data("colorpicker").color=Y=s(C(this.value))}else{if(this.parentNode.className.indexOf("_hsb")>0){ab.data("colorpicker").color=Y=g({h:parseInt(ab.data("colorpicker").fields.eq(4).val(),10),s:parseInt(ab.data("colorpicker").fields.eq(5).val(),10),b:parseInt(ab.data("colorpicker").fields.eq(6).val(),10)})}else{ab.data("colorpicker").color=Y=l(P({r:parseInt(ab.data("colorpicker").fields.eq(1).val(),10),g:parseInt(ab.data("colorpicker").fields.eq(2).val(),10),b:parseInt(ab.data("colorpicker").fields.eq(3).val(),10)}))}}ab.data("colorpicker").inputHexBlur.apply(ab,["3",Z])},O=function(){var aa=b(this).parent().parent(),Y;var Z="";if(this.parentNode.className.indexOf("_hex")>0){Z=C(this.value);aa.data("colorpicker").color=Y=s(C(this.value))}else{if(this.parentNode.className.indexOf("_hsb")>0){aa.data("colorpicker").color=Y=g({h:parseInt(aa.data("colorpicker").fields.eq(4).val(),10),s:parseInt(aa.data("colorpicker").fields.eq(5).val(),10),b:parseInt(aa.data("colorpicker").fields.eq(6).val(),10)})}else{aa.data("colorpicker").color=Y=l(P({r:parseInt(aa.data("colorpicker").fields.eq(1).val(),10),g:parseInt(aa.data("colorpicker").fields.eq(2).val(),10),b:parseInt(aa.data("colorpicker").fields.eq(3).val(),10)}))}}aa.data("colorpicker").inputHexFocus.apply(aa,["1",Z]);R=this.parentNode.className.indexOf("_hex")>0?70:65;b(this).parent().parent().data("colorpicker").fields.parent().removeClass("fk-colorpicker-focus");b(this).parent().addClass("fk-colorpicker-focus")},M=function(Y){var aa=b(this).parent().find("input").focus();var Z={el:b(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:(this.parentNode.className.indexOf("_hsb")>0?100:255),y:Y.pageY,field:aa,val:parseInt(aa.val(),10),preview:b(this).parent().parent().data("colorpicker").livePreview};b(document).bind("mouseup",Z,x);b(document).bind("mousemove",Z,Q)},Q=function(Y){Y.data.field.val(Math.max(0,Math.min(Y.data.max,parseInt(Y.data.val+Y.pageY-Y.data.y,10))));if(Y.data.preview){f.apply(Y.data.field.get(0),[true])}return false},x=function(Y){f.apply(Y.data.field.get(0),[true]);Y.data.el.removeClass("colorpicker_slider").find("input").focus();b(document).unbind("mouseup",x);b(document).unbind("mousemove",Q);return false},i=function(Y){var Z={cal:b(this).parent(),x:b(this).offset().left};Z.preview=Z.cal.data("colorpicker").livePreview;Y.data={cal:Z.cal,x:Z.x,preview:Z.preview};f.apply(Y.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(173-Math.max(9,Math.min(173,(Y.pageX-Y.data.x))))/164,0)).get(0),[Y.data.preview]);Z.cal.unbind("mouseup.upBrt").bind("mouseup.upBrt",Z,U).unbind("mousemove.moveBrt").bind("mousemove.moveBrt",Z,H)},H=function(ab){var ac=ab.data.cal,Z;var aa="";var Y=ab.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(173-Math.max(9,Math.min(173,(ab.pageX-ab.data.x))))/164,0)).get(0);if(Y.parentNode.className.indexOf("_hex")>0){aa=C(Y.value);ac.data("colorpicker").color=Z=s(C(Y.value))}else{if(Y.parentNode.className.indexOf("_hsb")>0){ac.data("colorpicker").color=Z=g({h:parseInt(ac.data("colorpicker").fields.eq(4).val(),10),s:parseInt(ac.data("colorpicker").fields.eq(5).val(),10),b:parseInt(ac.data("colorpicker").fields.eq(6).val(),10)})}else{ac.data("colorpicker").color=Z=l(P({r:parseInt(ac.data("colorpicker").fields.eq(1).val(),10),g:parseInt(ac.data("colorpicker").fields.eq(2).val(),10),b:parseInt(ac.data("colorpicker").fields.eq(3).val(),10)}))}}if(ab&&!aa){N(Z,ac.get(0));h(Z,ac.get(0));z(Z,ac.get(0))}p(Z,ac.get(0));r(Z,ac.get(0));J(Z,ac.get(0));f.apply(ac.data("colorpicker").fields.eq(6).val(parseInt(100*(173-Math.max(9,Math.min(173,(ab.pageX-ab.data.x))))/164,0)).get(0),[ab.data.preview,true]);return false},U=function(Y){var Z=Y.data.cal;N(Z.data("colorpicker").color,Z.get(0));h(Z.data("colorpicker").color,Z.get(0));Z.unbind("mouseup.upBrt",U).unbind("mousemove.moveBrt",H);f.apply(Z.data("colorpicker").fields.eq(6).val(parseInt(100*(173-Math.max(9,Math.min(173,(Y.pageX-Y.data.x))))/164,0)).get(0),[Y.data.preview]);return false},j=function(Z){var Y=Z.pageX-Z.data.pos.left-91,aa=Z.pageY-Z.data.pos.top-91;return Math.sqrt(Y*Y+aa*aa)},e=function(aa){var Y=aa.pageX-aa.data.pos.left-91,ab=aa.pageY-aa.data.pos.top-91;var Z=Math.round(Math.atan2(ab,Y)*180/Math.PI);if(ab<0){Z+=360}return Z},B=function(Y){var Z={cal:b(this).parent(),pos:b(this).offset()};Z.preview=Z.cal.data("colorpicker").livePreview;Y.data={cal:Z.cal,pos:Z.pos,preview:Z.preview};f.apply(Y.data.cal.data("colorpicker").fields.eq(4).val(parseInt(e(Y),0)).end().eq(5).val(parseInt(100*j(Y)/91,0)).get(0),[Y.data.preview]);Z.cal.unbind("mouseup.upSelector").bind("mouseup.upSelector",Z,E).unbind("mousemove.moveSelector").bind("mousemove.moveSelector",Z,w)},w=function(Y){f.apply(Y.data.cal.data("colorpicker").fields.eq(4).val(parseInt(e(Y),0)).end().eq(5).val(parseInt(100*j(Y)/91,0)).get(0),[Y.data.preview,true]);return false},E=function(Y){var Z=Y.data.cal;N(Z.data("colorpicker").color,Z.get(0));h(Z.data("colorpicker").color,Z.get(0));Z.unbind("mouseup.upSelector",E).unbind("mousemove.moveSelector",w);f.apply(Y.data.cal.data("colorpicker").fields.eq(4).val(parseInt(e(Y),0)).end().eq(5).val(parseInt(100*j(Y)/91,0)).get(0),[Y.data.preview]);return false},A=function(Y){b(this).addClass("fk-colorpicker-focus")},V=function(Y){b(this).removeClass("fk-colorpicker-focus")},v=function(Z){var aa=b(this).parent();var Y=aa.data("colorpicker").color;aa.data("colorpicker").origColor=Y;k(Y,aa.get(0));aa.data("colorpicker").onSubmit(Y,W(Y),m(Y),aa.data("colorpicker").el)},I=function(Y){var ac=b("#"+b(this).data("colorpickerId"));ac.data("colorpicker").onBeforeShow.apply(this,[ac.get(0)]);var ad=b(this).offset();var ab=D();var aa=ad.top+this.offsetHeight;var Z=ad.left;if(aa+176>ab.t+ab.h){aa-=this.offsetHeight+176}if(Z+356>ab.l+ab.w){Z-=356}ac.css({left:Z+"px",top:aa+"px"});if(ac.data("colorpicker").onShow.apply(this,[ac.get(0)])!=false){ac.show()}b(document).unbind("mousedown.calHide").bind("mousedown.calHide",{cal:ac},S);return false},S=function(Y){if(!L(Y.data.cal.get(0),Y.target,Y.data.cal.get(0))){if(Y.data.cal.data("colorpicker")&&Y.data.cal.data("colorpicker").onHide.apply(this,[Y.data.cal.get(0)])!=false){Y.data.cal.hide()}b(document).unbind("mousedown.calHide")}},L=function(aa,Z,Y){if(aa==Z){return true}if(aa.contains){return aa.contains(Z)}if(aa.compareDocumentPosition){return !!(aa.compareDocumentPosition(Z)&16)}var ab=Z.parentNode;while(ab&&ab!=Y){if(ab==aa){return true}ab=ab.parentNode}return false},D=function(){var Y=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(Y?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(Y?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(Y?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(Y?document.documentElement.clientHeight:document.body.clientHeight)}},g=function(Y){return{h:Math.min(360,Math.max(0,Y.h)),s:Math.min(100,Math.max(0,Y.s)),b:Math.min(100,Math.max(0,Y.b))}},P=function(Y){return{r:Math.min(255,Math.max(0,Y.r)),g:Math.min(255,Math.max(0,Y.g)),b:Math.min(255,Math.max(0,Y.b))}},C=function(aa){var Y=6-aa.length;if(Y>0){var ab=[];for(var Z=0;Z<Y;Z++){ab.push("0")}ab.push(aa);aa=ab.join("")}return aa},d=function(Y){var Y=parseInt(((Y.indexOf("#")>-1)?Y.substring(1):Y),16);return{r:Y>>16,g:(Y&65280)>>8,b:(Y&255)}},s=function(Y){return l(d(Y))},l=function(aa){var Z={h:0,s:0,b:0};var ab=Math.min(aa.r,aa.g,aa.b);var Y=Math.max(aa.r,aa.g,aa.b);var ac=Y-ab;Z.b=Y;if(Y!=0){}Z.s=Y!=0?255*ac/Y:0;if(Z.s!=0){if(aa.r==Y){Z.h=(aa.g-aa.b)/ac}else{if(aa.g==Y){Z.h=2+(aa.b-aa.r)/ac}else{Z.h=4+(aa.r-aa.g)/ac}}}else{Z.h=-1}Z.h*=60;if(Z.h<0){Z.h+=360}Z.s*=100/255;Z.b*=100/255;return Z},m=function(Y){var aa={};var ae=Math.round(Y.h);var ad=Math.round(Y.s*255/100);var Z=Math.round(Y.b*255/100);if(ad==0){aa.r=aa.g=aa.b=Z}else{var af=Z;var ac=(255-ad)*Z/255;var ab=(af-ac)*(ae%60)/60;if(ae==360){ae=0}if(ae<60){aa.r=af;aa.b=ac;aa.g=ac+ab}else{if(ae<120){aa.g=af;aa.b=ac;aa.r=af-ab}else{if(ae<180){aa.g=af;aa.r=ac;aa.b=ac+ab}else{if(ae<240){aa.b=af;aa.r=ac;aa.g=af-ab}else{if(ae<300){aa.b=af;aa.g=ac;aa.r=ac+ab}else{if(ae<360){aa.r=af;aa.g=ac;aa.b=af-ab}else{aa.r=0;aa.g=0;aa.b=0}}}}}}}return{r:Math.round(aa.r),g:Math.round(aa.g),b:Math.round(aa.b)}},G=function(Y){var Z=[Y.r.toString(16),Y.g.toString(16),Y.b.toString(16)];b.each(Z,function(aa,ab){if(ab.length==1){Z[aa]="0"+ab}});return Z.join("")},W=function(Y){return G(m(Y))},n=function(aa){var Z={};var ac=(2*Math.PI/360)*aa.h,ab=aa.s;if(ab>83){ab=83}var ad=Math.sin(ac)*ab+91,Y=Math.cos(ac)*ab+91;Z.left=Y;Z.top=ad;return Z},K=function(){var Z=b(this).parent();var Y=Z.data("colorpicker").origColor;Z.data("colorpicker").color=Y;N(Y,Z.get(0));h(Y,Z.get(0));z(Y,Z.get(0));p(Y,Z.get(0));r(Y,Z.get(0));J(Y,Z.get(0))};return{init:function(Y){var Z="";Y=b.extend({},F,Y||{});if(typeof Y.color=="string"){Z=Y.color;Y.color=s(Y.color)}else{if(Y.color.r!=undefined&&Y.color.g!=undefined&&Y.color.b!=undefined){Y.color=l(Y.color)}else{if(Y.color.h!=undefined&&Y.color.s!=undefined&&Y.color.b!=undefined){Y.color=g(Y.color)}else{return this}}}return this.each(function(){if(!b(this).data("colorpickerId")){var aa=b.extend({},Y);aa.origColor=Y.color;var ac="collorpicker_"+parseInt(Math.random()*1000);b(this).data("colorpickerId",ac);var ab=b(T).attr("id",ac);if(aa.flat){ab.appendTo(this).show();b(document).unbind("mousedown.calHide").bind("mousedown.calHide",{cal:ab},S);if(!window.WXApp){b.each(Site.getAllPopupWindow(),function(ad,ae){b(ae).length&&b(ae).unbind("mousedown.calHide").bind("mousedown.calHide",{cal:ab},S)})}}else{ab.appendTo(document.body)}aa.fields=ab.find("input").bind("keyup",q).bind("change",f).bind("blur",u).bind("focus",O).bind("keydown",t);ab.find("span").bind("mousedown",M).end().find(">div.J_colorpicker_current_color").bind("click",K);aa.selector=ab.find("div.J_colorpicker_color").unbind("mousedown.downSelector",B).bind("mousedown.downSelector",B);ab.find("div.J_colorpicker_color").on("click",function(ad){ad.stopPropagation()});ab.on("mousedown click mouseup mouseout mouseover mouseenter mouseleave",function(ad){ad.stopPropagation()});aa.selectorIndic=aa.selector.find("div div");aa.el=this;aa.brt=ab.find("div.J_colorpicker_brt div");ab.find("div.J_colorpicker_brt").unbind("mousedown.downBrt").bind("mousedown.downBrt",i);aa.newColor=ab.find("div.J_colorpicker_new_color");aa.currentColor=ab.find("div.J_colorpicker_current_color");ab.data("colorpicker",aa);ab.find("div.J_colorpicker_submit").bind("mouseenter",A).bind("mouseleave",V).bind("click",v);N(aa.color,ab.get(0));z(aa.color,ab.get(0));Z?o(Z,ab.get(0)):h(aa.color,ab.get(0));r(aa.color,ab.get(0));p(aa.color,ab.get(0));k(aa.color,ab.get(0));J(aa.color,ab.get(0));if(aa.flat){ab.css({display:"block"})}else{b(this).bind(aa.eventName,I)}}})},showPicker:function(){return this.each(function(){if(b(this).data("colorpickerId")){I.apply(this)}})},hidePicker:function(){return this.each(function(){if(b(this).data("colorpickerId")){b("#"+b(this).data("colorpickerId")).hide()}})},setColor:function(Y){var Z="";if(typeof Y=="string"){Z=Y;Y=s(Y)}else{if(Y.r!=undefined&&Y.g!=undefined&&Y.b!=undefined){Y=l(Y)}else{if(Y.h!=undefined&&Y.s!=undefined&&Y.b!=undefined){Y=g(Y)}else{return this}}}return this.each(function(){if(b(this).data("colorpickerId")){var aa=b("#"+b(this).data("colorpickerId"));aa.data("colorpicker").color=Y;aa.data("colorpicker").origColor=Y;N(Y,aa.get(0));z(Y,aa.get(0));Z?o(Z,aa.get(0)):h(options.color,aa.get(0));r(Y,aa.get(0));p(Y,aa.get(0));k(Y,aa.get(0));J(Y,aa.get(0))}})}}}();b.fn.extend({faiColorPickerAdven:a.init,faiColorPickerAdvenHide:a.hidePicker,faiColorPickerAdvenShow:a.showPicker,faiColorPickerAdvenSetColor:a.setColor})})(jQuery);