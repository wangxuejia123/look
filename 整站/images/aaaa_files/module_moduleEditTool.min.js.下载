Site.addModuleContextMenu=function(d){if(!Fai.top._contextMenu){return}if(!Fai.top._designAuth){return}if(!("contextMenu" in $)){return}if(Object.prototype.toString.call(d).toLowerCase()!="[object object]"){throw new Error("Site.addModuleContextMenu 参数错误");return}var s;$.contextMenu({selector:"#module"+d.id,className:"fk-moduleContextMenu fk-moduleContextMenu"+d.id,classNames:{icon:"f-icon"},build:function(ae,ao){var aa={},T={},R={},P={},O={},N={},M={},G=[M,T,P,R,O,N],K=d.id,E=Fai.top.$("#module"+K),aq=y(E),ag=d.moduleOperateList||{},I=d.moduleStateList||{},ab=d.moduleDirectionList||{},J=d.moduleOtherList||{},Y=I.length,an=ag.length,X=ab.length,al=J.length,W=false,Z=false,V=false,H=false,ad=false,D=false,Q=Site.checkModuleInZone(E),S=Site.checkNestModule(E),U=0,ap,C,af,aj,ah,am,L=Site.hasPopupModuleOpen();if(S.inPopupZone&&L&&!L.editing){return false}if(E.data("lockedit")!="lock"){for(am=0;am<an;am++){ap=ag[am];C=ap.iconClass||"oper"+am;af=ap.text;aj=ap.statusScript||1;ah=ap.evalScript;if(Fai.fkEval(aj)!=-1){W=true;Z=true;T[C]={};T[C]["name"]=af;T[C]["usehtml"]=true;T[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";T[C]["icon"]=C;T[C]["callback"]=F(ah)}}for(am=0;am<X;am++){ap=ab[am];C=ap.iconClass||"edit"+am;af=ap.text;aj=ap.statusScript||1;ah=ap.evalScript;if(Fai.fkEval(aj)!=-1){W=true;H=true;P[C]={};P[C]["name"]=af;P[C]["usehtml"]=true;P[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";P[C]["icon"]=C;P[C]["callback"]=F(ah)}}var ak=E.attr("_side"),B=E.attr("_flutterSwitch");if(ak==2&&Fai.top._canDesign){ah="Site.flutterStopSwitch('module"+K+"')";if(B=="true"){C="flutterStart";af="开始飘动"}else{C="flutterStop";af="停止飘动"}W=true;H=true;P[C]={};P[C]["name"]=af;P[C]["usehtml"]=true;P[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";P[C]["icon"]=C;P[C]["callback"]=F(ah);C="Location";af="设为飘动起始位置";ah='Site.flutterSetStartLocation("module'+K+'")';P[C]={};P[C]["name"]=af;P[C]["usehtml"]=true;P[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";P[C]["icon"]=C;P[C]["callback"]=F(ah)}if(I.length>0&&ac(I)>0&&ai(K)){C="hasSub J_hasSub J_moreState";af="设置模块状态";P[C]={};P[C]["name"]=af;P[C]["usehtml"]=true;P[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";P[C]["icon"]=C;P[C]["callback"]=function(){}}if(!aq.isFullmeasure){U++}if(J.length>0){U+=ac(J)}if(U>1){C="hasSub J_hasSub J_moreOpt";af="更多操作";O[C]={};O[C]["name"]=af;O[C]["usehtml"]=true;O[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";O[C]["icon"]=C;O[C]["callback"]=function(){}}else{if(J.length>0){ap=J[0];C=ap.iconClass||"other"+am;af=ap.text;aj=ap.statusScript||1;ah=ap.evalScript;if(Fai.fkEval(aj)!=-1){W=true;ad=true;O[C]={};O[C]["name"]=af;O[C]["usehtml"]=true;O[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";O[C]["icon"]=C;O[C]["callback"]=F(ah)}}if(!aq.isFullmeasure&&!aq.inPopupZone&&!aq.inSubNav){W=true;D=true;C="lockEdit";af="锁定当前排版";N[C]={};N[C]["name"]=af;N[C]["usehtml"]=true;N[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";N[C]["icon"]=C;N[C]["callback"]=function(){if(j({name:"moduleLockEdit"})=="1"){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},d.id)}else{o("锁定当前模块排版后，该模块不能移动，会减少误操作，<br/>也可以复制被选中的模块内容。",function(){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},d.id)})}Site.logDog(100045,41)}}}}else{if(!aq.isFullmeasure){W=true;D=true;C="openEdit";af="解锁当前排版";N[C]={};N[C]["name"]=af;N[C]["usehtml"]=true;N[C]["html"]="<div class='f-tip'></div><div>"+af+"</div>";N[C]["icon"]=C;N[C]["callback"]=function(){jzUtils.run({name:"moduleEditTool.openEdit",callMethod:true},d.id);Site.logDog(100045,42)}}}if(aq.inPack||Q||aq.inPopupZone||aq.inSubNav||aq.inBottomFloatLayer){q(E,aq,M)}for(am=0;am<G.length;am++){if(!r(aa)&&!r(G[am])){aa["sep"+am]="--"}aa=$.extend(aa,G[am])}if(r(aa)){Fai.ing("请将模块移离当前区域，再尝试右键操作",true);return false}return{items:aa};function ac(aw){var au=0,at=aw.length,av;for(var ar=0;ar<at;ar++){av=aw[ar].statusScript;if(av&&Fai.fkEval(av)!=-1){au++}}return au}function ai(au){var ar=$("#module"+au);if(ar.hasClass("formStyle97")&&!p(au)){return false}else{if(Site.isCartModule(ar)&&!at(ar)){return false}}return true;function at(ax){var az=Site.checkDockToModuleZone(ax),aw,ay,av;aw=az.type==1;ay=az.type==2;av=aw||ay;return av}}function F(ar){return function(au,at){Fai.fkEval(ar);switch(au){case"mtop":case"mbottom":case"mleft":case"mright":case"lock":case"dockModule":case"absModule":case"mzindex":case"flutterStop":Site.scrollToModuleDiv(Fai.top.$("#module"+d.id));Site.triggerGobalEvent("showFindModuleDiv",d.id);break;default:}}}},events:{show:function(){var C=Fai.top.$("#module"+d.id),E=y(C),G=-1,F,D;if(E.inTabId>0){G=E.inTabId}else{if(E.inMulColId>0){G=E.inMulColId}else{if(E.inFullmeasureId>0){G=E.inFullmeasureId}else{if(E.inPackId>0){G=E.inPackId}}}}if(G>0){F=Fai.top.$("#module"+G);Site.moduleEditTool.contextMenu(G,true)}Site.moduleEditTool.contextMenu(d.id,true);Site.removeAllEditLayer();Site.addMoveFrame("module"+d.id);if(C.attr("_side")=="2"&&C.attr("_flutterswitch")!="true"){C.attr("_edit",true);Site.stopFlutterInterval(C)}else{if(C.attr("_side")=="1"){C.off("mouseenter.sideModule").off("mouseleave.sideModule")}else{if(F&&F.length>0){D=F.attr("_side");if(D=="1"){F.off("mouseenter.sideModule").off("mouseleave.sideModule")}else{if(D=="2"&&F.attr("_flutterswitch")!="true"){F.attr("_edit",true);Site.stopFlutterInterval(F)}}}}}s=setTimeout(function(){var H=Fai.top.$("#module"+d.id);Site.addMoveFrame("module"+d.id);if(H.data("bottomLine")==1){Fai.top.$("#module"+d.id+"moveFrameBottom").css({opacity:1})}if(H.data("topLine")==1){Fai.top.$("#module"+d.id+"moveFrameTop").css({opacity:1})}if(H.data("leftLine")==1){Fai.top.$("#module"+d.id+"moveFrameLeft").css({opacity:1})}if(H.data("rightLine")==1){Fai.top.$("#module"+d.id+"moveFrameRight").css({opacity:1})}},200);var B=$(".fk-moduleContextMenu"+d.id);if(B.length>0){B.find(".J_hasSub").on({"mouseenter.subMenu":function(){g(d,$(this))},"mouseleave.subMenu":function(){n(d,$(this))}})}},hide:function(){clearTimeout(s);s=null;Site.removeMoveFrame("module"+d.id);var C=Fai.top.$("#module"+d.id),D=y(C),F=-1,E,B=$(".fk-moduleContextMenu"+d.id);if(B.length>0){B.off("mouseenter.subMenu mouseleave.subMenu")}if(D.inTabId>0){F=D.inTabId}else{if(D.inMulColId>0){F=D.inMulColId}else{if(D.inFullmeasureId>0){F=D.inFullmeasureId}else{if(D.inPackId>0){F=D.inPackId}}}}if(C.attr("_side")==2&&C.attr("_flutterswitch")!="true"){C.removeAttr("_edit");Site.startFlutterInterval(C)}else{if(C.attr("_side")==1){Site.reSetSidePosition(C)}}Site.moduleEditTool.contextMenu(d.id,false);if(F>0){E=Fai.top.$("#module"+F);Site.moduleEditTool.contextMenu(F,false);if(E.attr("_side")==2&&E.attr("_flutterswitch")!="true"){E.removeAttr("_edit");Site.startFlutterInterval(E)}else{if(E.attr("_side")==1){Site.reSetSidePosition(E)}}}}}});function k(C){var B=C.name||"",D=C.value,E=C.time||90;if(window.localStorage&&window.localStorage.setItem){window.localStorage.setItem(B,D)}else{$.cookie(B,D,{expires:E,path:"/"})}}function j(C){var B=C.name||"",D=false;if(window.localStorage&&window.localStorage.getItem){D=window.localStorage.getItem(B)}else{D=$.cookie(B,{path:"/"})}return D}function i(B){if(j({name:"moduleLockEdit"})=="1"){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},B.id)}else{o("锁定当前模块排版后，该模块不能移动，会减少误操作，<br/>也可以复制被选中的模块内容。",function(){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},B.id)})}Site.logDog(100045,41)}function v(G){var H=G.offset(),F=H.left,E=H.top,I=G.width(),B=G.height(),D=$(window),C=D.width(),J=D.height();if(F+I>C){G.addClass("fk-contextSubMenuWrap-right")}if(E+B>J){G.addClass("fk-contextSubMenuWrap-bottom")}}function u(D,C){function B(G,F){var H=[],E;H=H.concat(G.moduleStateList);H=H.concat(G.moduleOtherList);E=H.length;while(E){E--;if(H[E].iconClass===F){a(H[E].evalScript,F);return}}if(F==="lockEdit"){i(G)}}C.find(".J_subMenu").on("mouseup.subMenuItem",".J_subMenu-item",function(G){var H=$(this),E=H.attr("fk-icon-class");if(H.hasClass("J_subMenu-active")){G.stopPropagation();return}B(D,E);var F=Fai.top.$("#module"+D.id);if(F.hasClass("formStyle75")){Site.fixMsgSubmitStyle(D.id)}if(F.hasClass("formStyle32")){Site.fixSiteFormDateRangeStyle(D.id)}});C.off("mouseup.contextMenuItem mouseleave.removeActive").on({"mouseup.contextMenuItem":function(E){e(E,$(this))},"mouseleave.removeActive":function(){$(this).removeClass("context-menu-hover")}})}function h(C,B){B.find(".J_subMenu").off("mouseup.contextMenuItem");B.off("mouseup.contextMenuItem mouseleave.removeActive")}function e(B,K){var D=false,F=B.pageX,E=B.pageY,J=K.offset(),C=J.left,M=J.top,L=K.outerWidth(),G=K.outerHeight(),I=false,H=false;if(F>=C&&F<=(C+L)){I=true}if(E>=M&&E<=(M+G)){H=true}if(I&&H){B.stopPropagation()}}function g(E,C){var F,B,D;if(C.find(".J_subMenu").length>0){return}if(C.hasClass("J_moreState")){D=l(E)}else{if(C.hasClass("J_moreOpt")){D=c(E)}}if(!D){return}F=['<div class="fk-contextSubMenuWrap J_subMenuWrap">','<div class="fk-contextSubMenu J_subMenu">',D,"</div>","</div>"].join("");B=$(F);C.append(B);u(E,C);v(B)}function n(C,B){var D=B.find(".J_subMenuWrap");if(D.length==0){return}h(C,B);D.remove()}function l(B){var D=[],C;$(B.moduleStateList).each(function(J,E){var M=(E.iconClass||""),P=E.text.replace("模块","状态"),L=(E.statusScript||1),O="f-context-submenu-item J_subMenu-item f-subMenu-"+(E.iconClass||""),Q=false,H;if(M=="dockModule"){var G=Fai.top.$("#module"+B.id),K=G.hasClass("formStyle97"),F=G.hasClass("formStyle82");if(K){if(!p(B.id)){return true}}else{if(F){var R=Site.checkDockToModuleZone(G),N,I;N=R.type==1;I=R.type==2;if(!(N||I)){return true}}}}if(A(B)==M){Q=true;O+=" f-context-submenu-active J_subMenu-active"}if(Fai.fkEval(L)==-1&&!Q){return}if(M=="absModule"){C=J}H=m({cls:O,text:P,iconClass:M});D.push(H)});if(C!==undefined){D.push(D.splice(C,1))}return D.join("")}function c(D){var C=D.moduleOtherList,G=D.id,F=Fai.top.$("#module"+G),H=y(F),E=[],B=[];E=E.concat(D.moduleOtherList);if(!H.isFullmeasure){E=E.concat({text:"锁定当前排版",iconClass:"lockEdit"})}$(E).each(function(J,I){var L="f-context-submenu-item J_subMenu-item f-subMenu-"+(I.iconClass||""),K;if(Fai.fkEval(I.statusScript)!=-1){K=m({cls:L,text:I.text,iconClass:I.iconClass})}B.push(K)});return B.join("")}function m(C){var B="<li class='{#cls#}' fk-icon-class='{#iconClass#}'><span class='f-point'></span>{#text#}</li>";B=B.replace("{#cls#}",(C.cls||"")).replace("{#text#}",(C.text||"")).replace("{#iconClass#}",(C.iconClass||""));return B}function A(C){var B=Site.getModuleStatus(C.id),D=["dockModule","absModule","lock","flutterm","sidem"];return D[B-1]}function a(C,B){Fai.fkEval(C);switch(B){case"mtop":case"mbottom":case"mleft":case"mright":case"lock":case"dockModule":case"absModule":case"mzindex":case"flutterStop":Site.scrollToModuleDiv(Fai.top.$("#module"+d.id));Site.triggerGobalEvent("showFindModuleDiv",d.id);break;default:}}function o(C,D){var B=function(E){var F=this;return E("checkbox-component",{slot:"description",on:{input:function(G){F.nomoreTip=G}},props:{value:this.nomoreTip},"class":"f_lock_edit_tip_nomore"},"不再提示")};new Vue().$createDialog({onConfirm:function(){if(this.nomoreTip){k({name:"moduleLockEdit",value:"1",time:90})}D()},confirmButton:{text:"确 定"},cancelButton:{text:"取 消"},content:C,data:{nomoreTip:false},icon:"warning"},B)}function y(D){if(Object.prototype.toString.call(D).toLowerCase()!="[object object]"){throw new Error("contextMenu getModuleData 参数错误");return}var L=false,Q=false,S=0,G=false,M=false,J=0,P=false,V=false,F=0,I=false,C=false,T=false,R=false,B=0,K=false,N=false,E=0,W=false,H=false,U=0,O=false;if(D.hasClass("formStyle80")){L=true}else{if(D.hasClass("formStyle35")){P=true}else{if(D.hasClass("formStyle29")){G=true}else{if(D.hasClass("formStyle87")){T=true}else{if(D.hasClass("formStyle105")){W=true}}}}}if(D.hasClass("elemElemZone")){K=true}S=parseInt(D.attr("_infullmeasure"))||0;if(S>0){Q=true}J=parseInt(D.attr("_intab"))||0;if(J>0){M=true}F=parseInt(D.attr("_inmulmcol"))||0;if(F>0){V=true}B=parseInt(D.attr("_inpack"))||0;if(B>0){R=true}U=parseInt(D.attr("_inpopupzone"))||0;if(U>0){U=true}O=D.parent().hasClass("J_bottomFloatLayerContent");H=D.parent().hasClass("J_subNavPack");if(D.parent().hasClass("elemZone")){N=true;E=D.parent().attr("id")}if(G||P){I=true}if(M||V){C=true}return{isFullmeasure:L,inFullmeasure:Q,inFullmeasureId:S,isTab:G,inTab:M,inTabId:J,isMulCol:P,inMulCol:V,inMulColId:F,isMultiModule:I,inMultiModule:C,isPack:T,inPack:R,inPackId:B,isElemZone:K,inElemZone:N,inElemZoneId:E,isPopupZone:W,inPopupZone:U,inSubNav:H,inBottomFloatLayer:O}}function r(C){var B;for(B in C){return false}return true}function q(C,E,G){var F=C.nextAll(".form:visible").length>0?false:true,D=C.prevAll(".form:visible").length>0?false:true,K=C.siblings(".form:visible").length>0?true:false,I=F?" f-isTop":"",J=D?" f-isBottom":"",H,B;if(!K){return}H="topIndex"+I;B="置于顶层";G[H]={};G[H]["name"]=B;G[H]["usehtml"]=true;G[H]["html"]="<div class='f-tip'></div><div>"+B+"</div>";G[H]["icon"]=H;G[H]["callback"]=function(){Fai.top.Site.undoRun(b,{type:"module",detail:"置于顶层",id:parseInt(C.attr("_moduleid")),doArgs:[C],undoArgs:[C,Site.getModuleIndex(C)]});if(E.inPackId>0){Site.setModuleAttrDataChange(E.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()};H="upIndex"+I;B="上移一层";G[H]={};G[H]["name"]=B;G[H]["usehtml"]=true;G[H]["html"]="<div class='f-tip'></div><div>"+B+"</div>";G[H]["icon"]=H;G[H]["callback"]=function(){Fai.top.Site.undoRun(x,{type:"module",detail:"上移一层",id:parseInt(C.attr("_moduleid")),doArgs:[C,1],undoArgs:[C,-1]});if(E.inPackId>0){Site.setModuleAttrDataChange(E.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()};H="downIndex"+J;B="下移一层";G[H]={};G[H]["name"]=B;G[H]["usehtml"]=true;G[H]["html"]="<div class='f-tip'></div><div>"+B+"</div>";G[H]["icon"]=H;G[H]["callback"]=function(){Fai.top.Site.undoRun(x,{type:"module",detail:"下移一层",id:parseInt(C.attr("_moduleid")),doArgs:[C,-1],undoArgs:[C,1]});if(E.inPackId>0){Site.setModuleAttrDataChange(E.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()};H="bottomIndex"+J;B="置于底层";G[H]={};G[H]["name"]=B;G[H]["usehtml"]=true;G[H]["html"]="<div class='f-tip'></div><div>"+B+"</div>";G[H]["icon"]=H;G[H]["callback"]=function(){Fai.top.Site.undoRun(w,{type:"module",detail:"置于底层",id:parseInt(C.attr("_moduleid")),doArgs:[C],undoArgs:[C,Site.getModuleIndex(C)]});if(E.inPackId>0){Site.setModuleAttrDataChange(E.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()}}function b(B,E){if(typeof E=="undefined"){var D=B.nextAll(".form"),C=D.length>0?false:true;f(B,200302,10);if(!C){D.last().after(B)}}else{Fai.top._undo.insertElem&&Fai.top._undo.insertElem({module:B,index:E})}}function x(B,C){switch(C){case 1:z(B);break;case -1:t(B);break}}function z(B){var D=B.nextAll(".form:visible"),C=D.length>0?false:true;f(B,200302,12);if(!C){D.first().after(B)}}function w(D,E){if(typeof E=="undefined"){var C=D.prevAll(".form"),B=C.length>0?false:true;f(D,200302,11);if(!B){C.last().before(D)}}else{Fai.top._undo.insertElem&&Fai.top._undo.insertElem({module:D,index:E+1})}}function t(D){var C=D.prevAll(".form:visible"),B=C.length>0?false:true;f(D,200302,13);if(!B){C.first().before(D)}}function p(B){var H=$("#module"+B),J=$("#fk-webHeaderZone"),K,L,F,D,C,E,I,G;if(J.length){if(H.hasClass("formInZone")){return true}K=J.offset().left;L=J.offset().top;F=J.width();D=J.height();C=H.offset().left;E=H.offset().top;I=H.width();G=H.height();if(K<C&&L<E&&(K+F>C+I)&&(L+D>E+G)){return true}}else{return false}}function f(C,E,B){var D=Site.checkNestModule(C);if(!D.inPopupZone){return}Site.logDog(E,B)}};Site.moduleEditTool={};(function(M,R,r){var L=[];var w=function(){var ah={};return{lock:function(ai){ah[ai]=ah[ai]||{};ah[ai].lock=true},open:function(ai){ah[ai]=ah[ai]||{};delete ah[ai].lock},getStatus:function(aj){var ai=false;if(ah[aj]){ai=ah[aj].status}return ai},getActivePart:function(aj){var ai=-1;if(ah[aj]){if("part" in ah[aj]){ai=ah[aj].part}}return ai},isActive:function(aj,ai){ah[aj]=ah[aj]||{};if(!!ah[aj].lock){return}ah[aj].status=true;if(ai=="tool"){ah[aj].part=1}else{if(ai=="dragBtn"){ah[aj].part=2}else{if(ai=="resizeCancel"){ah[aj].part=3}else{if(ai=="child"){ah[aj].part=4}else{ah[aj].part=0}}}}},getContextMenu:function(ai){ah[ai]=ah[ai]||{};return ah[ai].contextMenu||false},getMultiModule:function(ai){ah[ai]=ah[ai]||{};return ah[ai].multiModule||false},isLeave:function(ai){ah[ai]=ah[ai]||{};if(!!ah[ai].lock){return}ah[ai].status=false;delete ah[ai].part},onContextMenu:function(ai){ah[ai]=ah[ai]||{};ah[ai].contextMenu=true},offContextMenu:function(ai){ah[ai]=ah[ai]||{};ah[ai].contextMenu=false},onMultiModule:function(ai){ah[ai]=ah[ai]||{};ah[ai].multiModule=true},offMultiModule:function(ai){ah[ai]=ah[ai]||{};ah[ai].multiModule=false},clearAll:function(ai){delete ah[ai]}}}();R.init=function(ah){if(Object.prototype.toString.call(ah).toLowerCase()!="[object object]"){throw new Error("Site.moduleEditTool.init 参数错误");return}var ai=Fai.top.$("#module"+ah.id),aj;if(ai.length<1){ah.moduleId=ah.id;Site.cacheModuleFunc.init("moduleEditTool.init",ah);return}ai.off("mousemove.moduleEdit").off("mouseleave.moduleEdit").off("mouseenter.moduleEdit").on("mousemove.moduleEdit",function(an){if(typeof aj=="number"){return}var ak=Site.hasPopupModuleOpen(),am=Site.checkNestModule(M(this));if(am.inPopupZone&&ak&&!ak.editing){return false}aj=setTimeout(function(){aj=null},300);Y(ah.id,"leaveParentModule");Y(ah.id,"leaveSideModule");Y(ah.id,"bindToolbarEvent_mouseleave");Y(ah.id,"initDrag");Y(ah.id,"bindToolbarEvent_mouseover");Y(ah.id,"initToolbar_mouseover");w.isActive(ah.id);var al=I(M(this)),ao=-1;if(al.inTabId>0){ao=al.inTabId}else{if(al.inMulColId>0){ao=al.inMulColId}else{if(al.inFullmeasureId>0){ao=al.inFullmeasureId}else{if(al.inPackId>0){ao=al.inPackId}}}}if(ao>0){Y(ao,"leaveParentModule");Y(ao,"leaveSideModule");w.open(ao);w.isActive(ao,"child");w.lock(ao)}V(ah);u(ah);Z(ah);ac(ah);l(ah);j(ah);if(!Fai.top.moveBtnExecuting&&!Fai.top.mouseoverLine&&!ah.isDialog){ad(ah.id)}}).on("mouseleave.moduleEdit",function(al){Y(ah.id,"leaveParentModule");Y(ah.id,"leaveSideModule");Y(ah.id,"bindToolbarEvent_mouseleave");w.isLeave(ah.id);var ak=I(M(this)),an=-1;if(ak.inTabId>0){an=ak.inTabId}else{if(ak.inMulColId>0){an=ak.inMulColId}else{if(ak.inFullmeasureId>0){an=ak.inFullmeasureId}else{if(ak.inPackId>0){an=ak.inPackId}}}}if(an>0){Y(an,"leaveParentModule");Y(an,"leaveSideModule");w.open(an);w.isLeave(an)}K(ah);p(ah);t(ah);a(ah);A(ah);Y(ah.id,"moduleEditMouseleave");var am=setTimeout(function(){if(!w.getStatus(ah.id)){C(ah)}},300);y(ah.id,"moduleEditMouseleave",am)}).on("mouseenter.moduleEdit",function(){Y(ah.id,"moduleEditMouseleave")});c(ah);F(ah);if(!Fai.top._canDesign){Site.removeDesignEditLayer()}if(!Fai.top._canEditData){Site.removeAllDataEditLayer()}};R.destroy=function(ai){var ah=Fai.top.$("#module"+ai);if(ah.length<1){return}ah.off("mousemove.moduleEdit").off("mouseleave.moduleEdit").off("mouseenter.floatFutterBorder").off("mouseleave.floatFutterBorder");if(ah.hasClass("formStyle86")){ah.off("mouseenter.editLine").off("mouseleave.editLine")}ah.find(".J_paddingMarginWrap").remove();M("#fk-moduleToolbar"+ai).remove();R.remove(ai)};R.remove=function(ah){C({id:ah})};R.contextMenu=function(ak,ah){var ai=I(Fai.top.$("#module"+ak)),aj=-1;if(ai.inTabId>0){aj=ai.inTabId}else{if(ai.inMulColId>0){aj=ai.inMulColId}else{if(ai.inFullmeasureId>0){aj=ai.inFullmeasureId}else{if(ai.inPackId>0){aj=ai.inPackId}}}}if(ah){w.onContextMenu(ak)}else{w.offContextMenu(ak)}U(ak);if(aj>0){if(ah){w.onContextMenu(aj)}else{w.offContextMenu(aj)}U(aj)}};R.lockEdit=function(ah){T(ah)};R.openEdit=function(ah){m(ah)};R.clickForOpenEdit=function(ah){m(ah);Fai.top.$("#module"+ah).children(".J_lockEditTip").addClass("fk-openEditTip").removeClass("fk-lockEditTip").removeAttr("onclick")};function c(ah){var ai=Fai.top.$("#module"+ah.id);if(ai.length<1){return}var aj=I(ai);if(aj.isMulCol||aj.isPack){ai.find(".formBanner"+ah.id).off("mouseover.moduleEdit").off("mouseleave.moduleEdit").on("mouseover.moduleEdit",function(){w.onMultiModule(ah.id)}).on("mouseleave.moduleEdit",function(){w.offMultiModule(ah.id)})}else{if(aj.isTab){ai.find(".titleTable").off("mouseover.moduleEdit").off("mouseleave.moduleEdit").on("mouseover.moduleEdit",function(){w.onMultiModule(ah.id)}).on("mouseleave.moduleEdit",function(){w.offMultiModule(ah.id)})}}}function b(ai){var aj=Fai.top.$("#fk-moduleToolbar"+ai.id),ah=Fai.top.$("#module"+ai.id);aj.off("mouseover.toolbar").off("mouseleave.toolbar").on("mouseover.toolbar",function(){var ak=Fai.top.$("#module"+ai.id),al=I(ak),ao=-1,am;if(al.inTabId>0){ao=al.inTabId}else{if(al.inMulColId>0){ao=al.inMulColId}else{if(al.inFullmeasureId>0){ao=al.inFullmeasureId}else{if(al.inPackId>0){ao=al.inPackId}}}}Y(ai.id,"dragBtnMouseover");Y(ai.id,"resizeCancelBtnMouseleave");Y(ai.id,"leaveSideModule");Y(ai.id,"leaveParentModule");w.open(ai.id);w.isActive(ai.id,"tool");O(ai.id);E(ai.id);if(ak.parent().hasClass("fk-inBannerListZone")&&Fai.top._bannerV2Data.bl&&Fai.top._bannerV2Data.bl.length>1){Site.bannerV2.stopBannerInterval()}if(ao>0){w.open(ao);w.isActive(ao,"child");w.lock(ao);Y(ao,"leaveSideModule");Y(ao,"leaveParentModule")}if(al.inFullmeasureId>0){M("#module"+al.inFullmeasureId).data("mouseenter",true)}if(ak.hasClass("formStyle80")){ak.data("mouseenter",true)}if(ak.attr("_side")=="2"){Site.stopFlutterInterval(ak)}if(ao>0){am=Fai.top.$("#module"+ao);if(am.attr("_side")=="2"){Site.stopFlutterInterval(am)}}Y(ai.id,"bindToolbarEvent_mouseleave");Y(ai.id,"bindToolbarEvent_mouseover");var an=setTimeout(function(){if(w.getStatus(ai.id)&&w.getActivePart(ai.id)==1){X(ai.id);P(ai.id);if(ao>0){X(ao)}}},300);y(ai.id,"bindToolbarEvent_mouseover",an)}).on("mouseleave.toolbar",function(){var ak=Fai.top.$("#module"+ai.id),al=I(ak),an=-1;if(al.inTabId>0){an=al.inTabId}else{if(al.inMulColId>0){an=al.inMulColId}else{if(al.inFullmeasureId>0){an=al.inFullmeasureId}else{if(al.inPackId>0){an=al.inPackId}}}}if(an>0){w.open(an);w.isLeave(an)}if(al.inFullmeasureId>0){M("#module"+al.inFullmeasureId).data("mouseenter",false)}if(ak.hasClass("formStyle80")){ak.data("mouseenter",false)}w.open(ai.id);w.isLeave(ai.id);Y(ai.id,"bindToolbarEvent_mouseover");Y(ai.id,"bindToolbarEvent_mouseleave");var am=setTimeout(function(){if(!w.getStatus(ai.id)){C(ai)}},300);y(ai.id,"bindToolbarEvent_mouseleave",am)});if(Site.simpleTip){if(ah.hasClass("formStyle80")){Site.simpleTip(aj.find(".J_title"),0,ai.isDialog)}else{Site.simpleTip(aj.find(".J_icon"),0,ai.isDialog)}}}function x(ah){Fai.top.$("#fk-moduleToolbar"+ah).remove()}function W(al){var at=al.id,aj=al.toolList,aA=aj.length||0,az=0,aq=[],aD,ax,aC,aE,ar,ak,an;if(aj.length<0){return}var ah=Fai.top.$("#fk-moduleToolbar"+at);if(ah.length>0){s(at,al);return}var ai=Fai.top.$("#module"+at),au=I(ai),aB=Site.getModuleAttrPattern(at),am="",ap=false,aw=Site.checkNestModule(ai);var ay="",av="",ao="";ay+=" fk-moduleToolbar-v2 ";if(au.isFullmeasure){am=" fk-moduleToolbar-fullmeasure-v2 "}if(aB.border.y===1&&aB.bannerType===1&&aB.contentBg.y===1){ap=true}aq.push("<div id='fk-moduleToolbar"+at+"' class=' J_moduleToolbar "+ay+am+"'>");if(au.isFullmeasure){for(az=0;az<aA;az++){aD=aj[az];ax=true;if(aD.statusScript){if(Fai.fkEval(aD.statusScript)==-1){ax=false}}if(!ax){continue}an=aD.toolDisplay;aC=aD.evalScript;ar=aD.text||"";aE=aD.text||"";az!=0&&(av=" data-title-tip='"+aE+"' ");ak=aD.toolClass||"";if(ak=="moduleLayerIconCarousel"){if(ai.data("stopCarousel")==true){ak="moduleLayerIconStop";ar="自动轮播";aE="自动轮播"}}if(an=="toolIcon"){ar="&nbsp;"}ao="";if(aA!=1&&az==0){ao+="f-toolItemLine"}aq.push("<div class='f-toolItem J_toolItem f-toolItem"+ak+"  "+ao+" '>");aq.push("<a class='f-title J_title' "+av+' onclick="'+aC+';Site.removeAllEditLayer();return false;">'+ar+"</a>");aq.push("</div>")}}else{for(az=0;az<aA;az++){aD=aj[az];ax=true;if(aD.statusScript){if(Fai.fkEval(aD.statusScript)==-1){ax=false}}if(!ax){continue}aC=aD.evalScript;aE=aD.text||"";ak=aD.iconClass||"";if(aw.inPopupZone&&ak=="bannerAndBorder"){continue}if(aD.setTB&&ax){if(ap){ak="resetTB";aE="显示外框";aC="Site.oneKeySwitchModuleTB("+at+", false)"}else{ak="clearTB";aE="隐藏外框";aC="Site.oneKeySwitchModuleTB("+at+", true)"}}ao="";if(aA!=1&&az==0){ao+="f-toolItemLine"}if(ak=="text"&&(az!=0&&az<aA-1)){ao+="f-toolItemLine"}if(au.isTab&&az==0){aE=au.isTabY?"编辑纵向标签":"编辑横向标签"}aq.push("<div class='f-toolItem J_toolItem f-toolItem"+ak+"  "+ao+" '>");if(ai.parent().hasClass("fk-inBannerListZone")&&Fai.top._bannerV2Data.bl&&Fai.top._bannerV2Data.bl.length>1){aq.push("<a class='f-title J_title' onclick=\""+aC+";Site.bannerV2.stopBannerInterval();Site.removeAllEditLayer();return false;\"><span class='J_icon f-icon' data-title-tip='"+aE+"' ></span><span class='f-icon f-onlyIcon' title='"+aE+"'></span><span class='f-text'>"+aE+"</span></a>")}else{aq.push("<a class='f-title J_title' onclick=\""+aC+";Site.removeAllEditLayer();return false;\"><span class='J_icon f-icon' data-title-tip='"+aE+"' ></span><span class='f-icon f-onlyIcon' title='"+aE+"'></span><span class='f-text'>"+aE+"</span></a>")}aq.push("</div>")}}aq.push("</div>");Fai.top.$("body").append(aq.join(""));s(at,al);b(al)}function V(ah){if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){ag(ah.id);return}Y(ah.id,"initToolbar_mouseover");var ai=setTimeout(function(){var ak=Fai.top.$("#module"+ah.id),aj=I(ak);if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){if(aj.isMultiModule||aj.isPack){if(w.getMultiModule(ah.id)){if(!ak.data("simpleText")&&!ak.data("floatImg")&&!ak.data("floatBtn")){W(ah);O(ah.id);if(Fai.top._newUserGuide){Site.newUserGuideForModule(Fai.top.$("#fk-moduleToolbar"+ah.id),ak)}}N(ak,ah.id)}else{W(ah);N(ak,ah.id);if(w.getActivePart(ah.id)!=2&&w.getActivePart(ah.id)!=1){ag(ah.id)}else{if(Fai.top._newUserGuide){Site.newUserGuideForModule(Fai.top.$("#fk-moduleToolbar"+ah.id),ak)}}}}else{if(aj.isPack){}else{if(!ak.data("simpleText")&&!ak.data("floatImg")&&!ak.data("floatBtn")){W(ah);O(ah.id);if(Fai.top._newUserGuide){Site.newUserGuideForModule(Fai.top.$("#fk-moduleToolbar"+ah.id),ak)}}N(ak,ah.id)}}}else{ag(ah.id)}},100);y(ah.id,"initToolbar_mouseover",ai)}function K(ah){Y(ah.id,"initToolbar_mouseleave");var ai=setTimeout(function(){var aj=Fai.top.$("#module"+ah.id);if(!w.getStatus(ah.id)){ag(ah.id)}},100);y(ah.id,"initToolbar_mouseleave",ai)}R.hidePaddingMarginWrap=function(aj){var ai=Fai.top.$("#module"+aj),ah=ai.find(">.J_paddingMarginWrap");if(ah.length<1){return}ah.find(".J_setting_btn_box").hide()};function aa(aj){var ai=Fai.top.$("#module"+aj),ah=ai.find(">.J_paddingMarginWrap");if(ah.length>0){ah.remove()}}function ad(ak){var aj=Fai.top.$("#module"+ak),ai="",ah;if(!Fai.top._designAuth){return}if(D(aj,ak)==-1){return}ah=aj.find(">.J_paddingMarginWrap");if(ah.length<1){ai='<div class="fk-paddingMarginWrap J_paddingMarginWrap"><div class="top-area J_setting_area J_top_area" direction="top"><div class="top-line J_top_line"></div><div class="fk-top-setting-btn J_top_setting_btn J_setting_btn_box" style="display:none"><a class="fk-top-padding-btn J_top_padding_btn fk-setting-btn" ></a><a class="fk-top-margin-btn J_top_margin_btn fk-setting-btn" ></a></div></div><div class="left-area J_setting_area J_left_area" direction="left"><div class="left-line J_left_line"></div><div class="fk-left-setting-btn J_left_setting_btn J_setting_btn_box" style="display:none"><a class="fk-left-padding-btn J_left_padding_btn fk-setting-btn" ></a><a class="fk-left-margin-btn J_left_margin_btn fk-setting-btn" ></a></div></div><div class="right-area J_setting_area J_right_area" direction="right"><div class="right-line J_right_line"></div><div class="fk-right-setting-btn J_right_setting_btn J_setting_btn_box" style="display:none"><a class="fk-right-padding-btn J_right_padding_btn fk-setting-btn" ></a><a class="fk-right-margin-btn J_right_margin_btn fk-setting-btn" ></a></div></div><div class="bottom-area J_setting_area J_bottom_area" direction="bottom"><div class="bottom-line J_bottom_line"></div><div class="fk-bottom-setting-btn J_bottom_setting_btn J_setting_btn_box" style="display:none"><a class="fk-bottom-padding-btn J_bottom_padding_btn fk-setting-btn" ></a><a class="fk-module-height-btn J_bottom_height_btn" ></a><a class="fk-bottom-margin-btn J_bottom_margin_btn fk-setting-btn" ></a></div></div></div>';aj.append(ai);ah=aj.find(">.J_paddingMarginWrap");z(ak,aj,ah);H(ak,0);J(ak)}else{ah.find(".J_setting_btn_box").hide();z(ak,aj,ah);H(ak,0)}}function D(al,an){var ah=1,am=Site.getModuleStatus(an),ak=Site.checkNestModule(al),ai=Site.checkModuleInZone(al),aj=Site.getModuleAttrPattern(an);if(al.hasClass("formStyle81")||al.hasClass("formStyle86")||al.hasClass("formStyle79")||al.hasClass("formStyle82")||al.hasClass("formStyle97")||al.hasClass("formStyle45")||al.hasClass("formStyle39")||al.hasClass("formStyle62")||al.hasClass("formStyle66")||al.hasClass("formStyle65")||al.hasClass("formStyle105")){ah=-1}if(ak.inTab||ak.inCol||ak.isFullmeasure||ak.isTab){ah=-1}if(am==3||am==4||am==5){ah=-1}if(ak.isPack&&am==2){ah=-1}if((am==2||ak.inPack||ai)&&aj.border.y==1&&aj.bannerType==1&&aj.contentBg.y==1){aa(an);ah=-1}return ah}function z(ai,ap,ar){var ah=Site.getModuleStatus(ai),aq=Site.checkNestModule(ap),ak=ar.find(".J_setting_btn_box"),ao=Site.checkModuleInZone(ap),an=Site.getModuleAttrPattern(ai),al=true,am=true,aj=true;if(ah==2||aq.inPack||ao||aq.inElemZone){am=false}if(aq.isPack||(an.border.y==1&&an.bannerType==1&&an.contentBg.y==1)){al=false}if(!al||!am){aj=false}if(!am){ar.addClass("fk-paddingMarginWrap-float");ak.find(".J_top_margin_btn").hide();ak.find(".J_left_margin_btn").hide();ak.find(".J_right_margin_btn").hide();ak.find(".J_bottom_margin_btn").hide()}else{ar.removeClass("fk-paddingMarginWrap-float");ak.find(".J_top_margin_btn").show();ak.find(".J_left_margin_btn").show();ak.find(".J_right_margin_btn").show();ak.find(".J_bottom_margin_btn").hide()}if(!al){ar.addClass("fk-paddingMarginWrap-pack");ak.find(".J_top_padding_btn").hide();ak.find(".J_left_padding_btn").hide();ak.find(".J_right_padding_btn").hide();ak.find(".J_bottom_padding_btn").hide()}else{ar.removeClass("fk-paddingMarginWrap-pack");ak.find(".J_top_padding_btn").hide();ak.find(".J_left_padding_btn").hide();ak.find(".J_right_padding_btn").hide();ak.find(".J_bottom_padding_btn").hide()}if(!aj){ak.find(".J_bottom_height_btn").hide()}else{ak.find(".J_bottom_height_btn").show()}if(aq.isCol||aq.isPack||aq.isTab){ar.addClass("fk-paddingMarginWrap-multiM")}else{ar.removeClass("fk-paddingMarginWrap-multiM")}}function H(ar,au){var am=Fai.top.$("#module"+ar),aj=am.find(">.J_paddingMarginWrap"),an,az,ai,aw,al,at,ak,ay,ap,ao=0,aq=false,av,ax=0,ah=0;if(aj.length<1){return}av=Site.getModuleAttrPattern(ar).border;an=am.innerWidth();az=am.innerHeight();ai=am.offset().top;ap=M(window).height();if(az>=300){if(ai>0){ao=ap-ai;if(ao>=300){aq=true}}else{ao=az+ai;if(ao>=300){aq=true}}if(ao>ap){ao=ap}if(ao>az){ao=az}}if(!!av&&av.y!=0){ax=am.css("border-top-width");if(ax.indexOf("px")!=-1){ax=parseInt(ax)}else{ax=0}ah=am.css("border-left-width");if(ah.indexOf("px")!=-1){ah=parseInt(ah)}else{ah=0}}if(au==0||au==1){aj.find(".J_top_area").width(an)}if(au==0||au==2){if(aq){aj.find(".J_left_area").height(ao);if(ai<0){aj.find(".J_left_area").css("top",-ai+"px")}else{aj.find(".J_left_area").css("top","0")}}else{aj.find(".J_left_area").height(az)}}if(au==0||au==3){if(aj.hasClass("fk-paddingMarginWrap-float")){ay=am.offset().left+ah-13}else{ay=am.offset().left+ah-10}aj.find(".J_right_area").offset({left:an+ay});if(aq){aj.find(".J_right_area").height(ao);if(ai<0){aj.find(".J_right_area").css("top",-ai+"px")}else{aj.find(".J_right_area").css("top","0")}}else{aj.find(".J_right_area").height(az)}}if(au==0||au==4){ak=ai+ax-10;aj.find(".J_bottom_area").width(an);aj.find(".J_bottom_area").offset({top:az+ak})}}function h(am,ai){var al=Fai.top.$("#module"+am),ah=al.find(">.J_paddingMarginWrap"),ak,aj;if(ah.length<1){return}ah.show();aj=ah.find(".J_setting_btn_box").hide();if(ai==0||ai==1){ak=ah.find(".J_top_setting_btn");ak.show()}if(ai==0||ai==2){ak=ah.find(".J_left_setting_btn");ak.show()}if(ai==0||ai==3){ak=ah.find(".J_right_setting_btn");ak.show()}if(ai==0||ai==4){ak=ah.find(".J_bottom_setting_btn");ak.show()}}function J(aB){var an=M("#module"+aB),aE=Site.getModuleAttrPattern(aB),ak=an.find(">.J_paddingMarginWrap"),ai=ak.find(".J_setting_area"),aq,aF,ah,al,ar,ap,at,aH,aj,aC,aI,am,aG,aJ;var aw=Fai.top.$("#dockTip");if(aw.length<1){aw=M("<div id='dockTip' class='resizableToShowWidth dockTip'></div>");Fai.top.$("body").append(aw)}an.children(".ui-resizable-s").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(aB,4);Fai.top.mouseoverLine=true});an.children(".ui-resizable-n").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(aB,1);Fai.top.mouseoverLine=true});an.children(".ui-resizable-w").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(aB,2);Fai.top.mouseoverLine=true});an.children(".ui-resizable-e").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(aB,3);Fai.top.mouseoverLine=true});ai.off("mouseover.btn").on("mouseover.btn",function(aL){if(!Site._enableEditLayer){return}var aM=M(this).attr("direction");var aK=M(aL.target);if(!!Fai.top.moveBtnExecuting){return}Fai.top.mouseoverLine=true;if(aM=="top"){h(aB,1)}else{if(aM=="left"){h(aB,2)}else{if(aM=="right"){h(aB,3)}else{if(aM=="bottom"){h(aB,4)}}}}if(aK.hasClass("J_bottom_padding_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整下内边距");d(aK.parent(),aw,7)},200)}else{if(aK.hasClass("J_bottom_margin_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整下外边距");d(aK.parent(),aw,8)},200)}else{if(aK.hasClass("J_top_padding_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整上内边距");d(aK.parent(),aw,1)},200)}else{if(aK.hasClass("J_top_margin_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整上外边距");d(aK.parent(),aw,2)},200)}else{if(aK.hasClass("J_left_padding_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整左内边距");d(aK.parent(),aw,3)},200)}else{if(aK.hasClass("J_left_margin_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整左外边距");d(aK.parent(),aw,4)},200)}else{if(aK.hasClass("J_right_padding_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整右内边距");d(aK.parent(),aw,5)},200)}else{if(aK.hasClass("J_right_margin_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整右外边距");d(aK.parent(),aw,6)},200)}else{if(aK.hasClass("J_bottom_height_btn")){aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){aw.show().text("按住鼠标拖动，可随意调整高度");d(an,aw,9)},200)}}}}}}}}}}).off("mouseleave.btn").on("mouseleave.btn",function(){if(!Site._enableEditLayer){return}if(!!Fai.top.moveBtnExecuting){return}aw.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.mouseoverLine=false});an.off("mouseleave.PMbtn").on("mouseleave.PMbtn",function(){if(!!Fai.top.moveBtnExecuting){return}Fai.top.mouseoverLine=false;R.hidePaddingMarginWrap(aB)});Fai.top.$("#g_main").off("scroll.forDockTip").on("scroll.forDockTip",function(){if(!!Fai.top.moveBtnExecuting){return}aw.hide()});var aA=null;ak.find(".J_top_padding_btn").draggable("destroy").draggable({handle:".J_top_padding_btn",axis:"y",revert:true,helper:function(){var aK='<div class="fk-paddingLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-top-padding-selected");aq=aL.offset.top;ah=parseInt(an.find(".formMiddleContent"+aB).css("margin-top").replace("px",""));aA=ah},drag:function(aL,aM){var aK=aM.offset.top-aq+ah;ax(2,aK);d(M(this).parent(),aw,1);H(aB,0)},stop:function(aL,aM){M(this).removeClass("fk-top-padding-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();ao(aB,1);var aK=parseInt(an.find(".formMiddleContent"+aB).css("margin-top").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(ax,{type:"module.paddingDrag",detail:"modulePaddingTopDrag",undoArgs:[2,aA],redoArgs:[2,aK]});aA=aK=null}}});ak.find(".J_top_margin_btn").draggable("destroy").draggable({handle:".J_top_margin_btn",axis:"y",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-top-margin-selected");aq=aL.offset.top;aF=parseInt(an.css("margin-top").replace("px",""));aA=aF},drag:function(aK,aM){var aL=aM.offset.top-aq+aF;au(2,aL);d(M(this).parent(),aw,2)},stop:function(aL,aM){M(this).removeClass("fk-top-margin-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();Site.logDog(100045,47);var aK=parseInt(an.css("margin-top").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(au,{type:"module.marginDrag",detail:"moduleMarginTopDrag",undoArgs:[2,aA],redoArgs:[2,aK]});aA=aK=null}}});ak.find(".J_left_padding_btn").draggable("destroy").draggable({handle:".J_left_padding_btn",axis:"x",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-left-padding-selected");al=aL.offset.left;ap=parseInt(an.find(".formMiddleContent"+aB).css("margin-left").replace("px",""));aA=ap},drag:function(aL,aM){var aK=aM.offset.left-al+ap;ax(0,aK);d(M(this).parent(),aw,3);H(aB,4)},stop:function(aL,aM){M(this).removeClass("fk-left-padding-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();ao(aB,2);var aK=parseInt(an.find(".formMiddleContent"+aB).css("margin-left").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(ax,{type:"module.paddingDrag",detail:"modulePaddingLeftDrag",undoArgs:[0,aA],redoArgs:[0,aK]});aA=aK=null}}});ak.find(".J_left_margin_btn").draggable("destroy").draggable({handle:".J_left_margin_btn",axis:"x",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-left-margin-selected");al=aL.offset.left;ar=parseInt(an.css("margin-left").replace("px",""));aA=ar},drag:function(aK,aM){var aL=aM.offset.left-al+ar;au(0,aL);d(M(this).parent(),aw,4);H(aB,3)},stop:function(aL,aM){M(this).removeClass("fk-left-margin-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();Site.logDog(100045,49);var aK=parseInt(an.css("margin-left").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(au,{type:"module.marginDrag",detail:"moduleMarginLeftDrag",undoArgs:[0,aA],redoArgs:[0,aK]});aA=aK=null}}});ak.find(".J_right_padding_btn").draggable("destroy").draggable({handle:".J_right_padding_btn",axis:"x",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-right-padding-selected");at=aL.offset.left;aj=parseInt(an.find(".formMiddleContent"+aB).css("margin-right").replace("px",""));aA=aj},drag:function(aK,aL){var aM=at-aL.offset.left+aj;ax(1,aM);d(M(this).parent(),aw,5);H(aB,4)},stop:function(aL,aM){M(this).removeClass("fk-right-padding-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();ao(aB,3);var aK=parseInt(an.find(".formMiddleContent"+aB).css("margin-right").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(ax,{type:"module.paddingDrag",detail:"modulePaddingRightDrag",undoArgs:[1,aA],redoArgs:[1,aK]});aA=aK=null}}});ak.find(".J_right_margin_btn").draggable("destroy").draggable({handle:".J_right_margin_btn",axis:"x",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-right-margin-selected");at=aL.offset.left;aH=parseInt(an.css("margin-right").replace("px",""));aA=aH},drag:function(aK,aM){var aL=at-aM.offset.left+aH;au(1,aL);d(M(this).parent(),aw,6);H(aB,0)},stop:function(aL,aM){M(this).removeClass("fk-right-margin-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();Site.logDog(100045,50);var aK=parseInt(an.css("margin-right").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(au,{type:"module.marginDrag",detail:"moduleMarginRightDrag",undoArgs:[1,aA],redoArgs:[1,aK]});aA=aK=null}}});ak.find(".J_bottom_padding_btn").draggable("destroy").draggable({handle:".J_bottom_padding_btn",axis:"y",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-bottom-padding-selected");aC=aL.offset.top;am=parseInt(an.find(".formMiddleContent"+aB).css("margin-bottom").replace("px",""));aA=am},drag:function(aK,aL){var aM=aL.offset.top-aC+am;ax(3,aM);d(M(this).parent(),aw,7);H(aB,0)},stop:function(aL,aM){M(this).removeClass("fk-bottom-padding-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();ao(aB,4);var aK=parseInt(an.find(".formMiddleContent"+aB).css("margin-bottom").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(ax,{type:"module.marginDrag",detail:"modulemarginBottomDrag",undoArgs:[3,aA],redoArgs:[3,aK]});aA=aK=null}}});ak.find(".J_bottom_margin_btn").draggable("destroy").draggable({handle:".J_bottom_margin_btn",axis:"y",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).parent().show();aw.show();az(1);Site.disableEditLayer();M(this).addClass("fk-bottom-margin-selected");aC=aL.offset.top;aI=parseInt(an.css("margin-bottom").replace("px",""));aA=aI},drag:function(aK,aL){var aM=aL.offset.top-aC+aI;au(3,aM);d(M(this).parent(),aw,8)},stop:function(aL,aM){M(this).removeClass("fk-bottom-margin-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();Site.logDog(100045,48);var aK=parseInt(an.css("margin-bottom").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(au,{type:"module.marginDrag",detail:"modulemarginBottomDrag",undoArgs:[3,aA],redoArgs:[3,aK]});aA=aK=null}}});var ay=null;ak.find(".J_bottom_height_btn").draggable("destroy").draggable({handle:".J_bottom_height_btn",axis:"y",revert:true,helper:function(){var aK='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aK)},start:function(aK,aL){Fai.top.moveBtnExecuting=true;M(this).addClass("fk-module-height-selected");M(this).parent().show();aw.show();az(1);Site.disableEditLayer();aG=aL.offset.top;aJ=parseInt(an.css("height").replace("px",""));an.attr("_autoheight",0);aA=aJ},drag:function(aL,aM){if(typeof ay=="number"){return}ay=setTimeout(function(){ay=null},60);var aK=aM.offset.top-aG+aJ;if(aK<0||aK>2000){return}if(aK>=0&&aK<10){aK=10}an.css("height",aK+"px");aw.text("高度 : "+aK);d(an,aw,9);Site.refreshModuleHeightForStop(an,aB)},stop:function(aL,aM){M(this).removeClass("fk-module-height-selected");aw.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;az(0);Site.enableEditLayer();aD();Site.logDog(100045,59);var aK=parseInt(an.css("height").replace("px",""));if(aA!==null&&!isNaN(aK)){Site.undoRun(av,{type:"module.heightDrag",detail:"moduleHeightBottomDrag",undoArgs:[aB,aA],redoArgs:[aB,aK]});aA=aK=null}}});function av(aM,aL){var aK=Fai.top.$("#module"+aM);aK.css("height",height+"px");H(aM,0);Site.refreshModuleHeightForStop(aK,aM)}function au(aK,aP){var aL=parseInt(an.parent().outerWidth()/2),aQ=aE.outside,aO,aN,aM;aQ.y=1;Site.setModuleStyleCss(aB,"","padding",0+"px");if(aK==0){if(aP<-500){return}if(aP>=-500&&aP<0){aP=0}if(typeof aQ.r=="undefined"){aQ.r=0}aN=parseInt(an.css("margin-right"));if(aN!=aQ.r){aQ.r=aN}aM=aL-aQ.r;if(aP>aM){aP=aM}aQ.l=aP;if(aP==0){aw.html("左外边距 : "+aP+"<br>外边距不支持拖动负值，请往右拖")}else{if(aP==aM){aw.html("左外边距 : "+aP+"<br>左右外边距的和，不能超过"+aL+"px")}else{aw.text("左外边距 : "+aP)}}Site.setModuleStyleCss(aB,"","margin-left",aP+"px")}else{if(aK==1){if(aP<-500){return}if(aP>=-500&&aP<0){aP=0}if(typeof aQ.l=="undefined"){aQ.l=0}aO=parseInt(an.css("margin-left"));if(aO!=aQ.l){aQ.l=aO}aM=aL-aQ.l;if(aP>aM){aP=aM}aQ.r=aP;if(aP==0){aw.html("右外边距 : "+aP+"<br>外边距不支持拖动负值，请往左拖")}else{if(aP==aM){aw.html("右外边距 : "+aP+"<br>左右外边距的和，不能超过"+aL+"px")}else{aw.text("右外边距 : "+aP)}}Site.setModuleStyleCss(aB,"","margin-right",aP+"px")}else{if(aK==2){if(aP<-500){return}if(aP>=-500&&aP<0){aP=0}if(aP>1000){aP=1000}aQ.t=aP;if(aP==0){aw.html("上外边距 : "+aP+"<br>外边距不支持拖动负值，请往下拖")}else{if(aP==1000){aw.html("上外边距 : "+aP+"<br>拖动范围为小于1000的数值")}else{aw.text("上外边距 : "+aP)}}Site.setModuleStyleCss(aB,"","margin-top",aP+"px")}else{if(aK==3){if(aP<-500){return}if(aP>=-500&&aP<0){aP=0}if(aP>1000){aP=1000}aQ.b=aP;if(aP==0){aw.html("下外边距 : "+aP+"<br>外边距不支持拖动负值，请往下拖")}else{if(aP==1000){aw.html("下外边距 : "+aP+"<br>拖动范围为小于1000的数值")}else{aw.text("下外边距 : "+aP)}}Site.setModuleStyleCss(aB,"","margin-bottom",aP+"px")}}}}Site.refreshModuleHeight(aB)}function ax(aK,aO){var aL=aE.inner,aM=parseInt(an.outerWidth()/2),aN;aL.y=1;Site.setModuleStyleCss(aB,".formMiddleContent"+aB,"padding",0+"px");if(aK==0){if(aO<-100){aO=-100}if(typeof aL.r=="undefined"){aL.r=0}aN=aM-aL.r;if(aO>aN){aO=aN}aL.l=aO;if(aO==-100){aw.html("左内边距 : "+aO+"<br>拖动范围为大于等于-100的数值")}else{if(aO==aN){aw.html("左内边距 : "+aO+"<br>左右内边距的和，不能超过"+aM+"px")}else{aw.text("左内边距 : "+aO)}}if(an.hasClass("formStyle76")){Site.setModuleStyleCss(aB,".formMiddleContent"+aB+" .p_m_cotainer","padding-left",aO+"px")}else{Site.setModuleStyleCss(aB,".formMiddleContent"+aB,"margin-left",aO+"px")}}else{if(aK==1){if(aO<-100){aO=-100}if(typeof aL.l=="undefined"){aL.l=0}aN=aM-aL.l;if(aO>aN){aO=aN}aL.r=aO;if(aO==-100){aw.html("右内边距 : "+aO+"<br>拖动范围为大于等于-100的数值")}else{if(aO==aN){aw.html("右内边距 : "+aO+"<br>左右内边距的和，不能超过"+aM+"px")}else{aw.text("右内边距 : "+aO)}}if(an.hasClass("formStyle76")){Site.setModuleStyleCss(aB,".formMiddleContent"+aB+" .p_m_cotainer","padding-right",aO+"px")}else{Site.setModuleStyleCss(aB,".formMiddleContent"+aB,"margin-right",aO+"px")}}else{if(aK==2){if(aO<-100||aO>=1000){aO=aO<-100?-100:999}aL.t=aO;if(aO==-100||aO==999){aw.html("上内边距 : "+aO+"<br>拖动范围为大于等于-100，小于1000的数值")}else{aw.text("上内边距 : "+aO)}Site.setModuleStyleCss(aB,".formMiddleContent"+aB,"margin-top",aO+"px")}else{if(aK==3){if(aO<-100||aO>=1000){aO=aO<-100?-100:999}aL.b=aO;if(aO==-100||aO==999){aw.html("下内边距 : "+aO+"<br>拖动范围为大于等于-100，小于1000的数值")}else{aw.text("下内边距 : "+aO)}Site.setModuleStyleCss(aB,".formMiddleContent"+aB,"margin-bottom",aO+"px")}}}}Site.refreshModuleHeight(aB)}function aD(){aE.changed=true;Site.styleChanged()}function az(aK){if(aK==1){an.addClass("form-for-paddingMargin-wrap")}else{an.removeClass("form-for-paddingMargin-wrap")}}function ao(aM,aK){var aL=Site.getModuleStatus(aM);if(aL==2){switch(aK){case 1:Site.logDog(100045,55);break;case 2:Site.logDog(100045,57);break;case 3:Site.logDog(100045,58);break;case 4:Site.logDog(100045,56);break;default:}}else{if(aL==1){switch(aK){case 1:Site.logDog(100045,51);break;case 2:Site.logDog(100045,53);break;case 3:Site.logDog(100045,54);break;case 4:Site.logDog(100045,52);break;default:}}}}}function d(ap,al,ao){var am,aj,an,ak,ah,ai;if(ap.length<1||al.length<1){return}am=ap.offset().top;aj=ap.offset().left;if(ao==1){ah=al.outerWidth();al.offset({top:am,left:aj-ah-10})}else{if(ao==2){an=ap.outerWidth();al.offset({top:am,left:aj+an+10})}else{if(ao==3){ai=al.outerHeight();al.offset({top:am-ai-10,left:aj})}else{if(ao==4){ak=ap.outerHeight();al.offset({top:am+ak+10,left:aj})}else{if(ao==5){ai=al.outerHeight();an=ap.outerWidth();ah=al.outerWidth();al.offset({top:am-ai-10,left:aj+an-ah})}else{if(ao==6){ak=ap.outerHeight();an=ap.outerWidth();ai=al.outerHeight();ah=al.outerWidth();al.offset({top:am+ak+10,left:aj+an-ah})}else{if(ao==7){ak=ap.outerHeight();ah=al.outerWidth();ai=al.outerHeight();al.offset({top:am+ak-ai,left:aj-ah-10})}else{if(ao==8){ak=ap.outerHeight();an=ap.outerWidth();ai=al.outerHeight();al.offset({top:am+ak-ai,left:aj+an+10})}else{if(ao==9){ak=ap.outerHeight();an=ap.outerWidth();ah=al.outerWidth();al.offset({top:am+ak+5,left:aj-ah/2+an/2})}}}}}}}}}}function u(ai){if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){return}var ak=Fai.top.$("#module"+ai.id),al=w.getActivePart(ai.id),ah=w.getStatus(ai.id),aj=(al==1||al==2||al==3);if(ah&&al!=4){Site.removeMoveFrame("module"+ai.id);Site.addMoveFrame("module"+ai.id)}else{if(ah&&!aj){Site.removeMoveFrame("module"+ai.id)}}Site.refreshResizableHandles(ak)}function p(ai){var ak=Fai.top.$("#module"+ai.id),al=w.getActivePart(ai.id),ah=w.getStatus(ai.id),aj=(al==1||al==2||al==3);if(aj){E(ai.id)}else{Site.removeMoveFrame("module"+ai.id)}}function E(ai){var ah=Fai.top.$("#module"+ai);Site.addMoveFrame("module"+ai);if(ah.data("bottomLine")==1){Fai.top.$("#module"+ai+"moveFrameBottom").css({opacity:1})}if(ah.data("topLine")==1){Fai.top.$("#module"+ai+"moveFrameTop").css({opacity:1})}if(ah.data("leftLine")==1){Fai.top.$("#module"+ai+"moveFrameLeft").css({opacity:1})}if(ah.data("rightLine")==1){Fai.top.$("#module"+ai+"moveFrameRight").css({opacity:1})}}function Z(ah){if(!Fai.top._canDesign){return}if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){X(ah.id);if(M("#module"+ah.id).data("simpleText")){M("#fkEditor-toolBar-"+ah.id).css("display","none")}return}af(ah.id);if(w.getActivePart(ah.id)==4){Q(ah.id)}}function t(ah){Y(ah.id,"initDrag");var ai=setTimeout(function(){if(!w.getStatus(ah.id)){X(ah.id)}else{if(w.getActivePart(ah.id)==4){Q(ah.id)}}},100);y(ah.id,"initDrag",ai)}function ac(ah){if(!Fai.top._canDesign){return}if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){P(ah.id);return}if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){if(!Fai.top.$("#module"+ah.id).hasClass("formStyle85")){G(ah.id)}if(!Fai.top.$("#module"+ah.id).hasClass("formStyle98")){G(ah.id)}}else{P(ah.id)}}function a(ah){Y(ah.id,"initResizeCancel_mouseleave");var ai=setTimeout(function(){!w.getStatus(ah.id)&&P(ah.id)},100);y(ah.id,"initResizeCancel_mouseleave",ai)}function F(ah){Fai.top.$("#module"+ah.id).delegate(".J_resizableTip","mouseover.resizeCancelBtn",function(){w.isActive(ah.id,"resizeCancel");w.lock(ah.id);Y(ah.id,"resizeCancelBtnMouseover");Y(ah.id,"resizeCancelBtnMouseleave");var ai=setTimeout(function(){if(w.getActivePart(ah.id)==3){X(ah.id);ag(ah.id,400)}},300);y(ah.id,"resizeCancelBtnMouseover",ai)}).delegate(".J_resizableTip","mouseleave.resizeCancelBtn",function(){w.open(ah.id);w.isLeave(ah.id);Y(ah.id,"resizeCancelBtnMouseover");Y(ah.id,"resizeCancelBtnMouseleave");var ai=setTimeout(function(){if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){O(ah.id);ae(ah.id)}},100);y(ah.id,"resizeCancelBtnMouseleave",ai)})}function l(ah){if(!Fai.top._canDesign){return}if(o(ah.id)){return}if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){B(ah.id);return}if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){ab(ah.id)}else{B(ah.id)}}function A(ah){var ai=setTimeout(function(){!w.getStatus(ah.id)&&B(ah.id)},100)}function j(ai){var ak=Fai.top.$("#module"+ai.id);if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){Site.removeMoveFrame("module"+ai.id);ak.children(".ui-resizable-handle").hide();return}var al=w.getActivePart(ai.id),ah=w.getStatus(ai.id),aj=(al==1||al==2||al==3);if(ah&&al!=4){ak.children(".ui-resizable-handle").removeClass("fk-childModuleHover").show()}else{if(ah&&al==4){ak.children(".ui-resizable-handle").addClass("fk-childModuleHover").show()}else{if(ah&&!aj){ak.children(".ui-resizable-handle").hide()}}}}function s(aD,aA){var aC=Fai.top.$("#fk-moduleToolbar"+aD);if(aC.length<0){return}var ak=Fai.top.$("#module"+aD),aR=I(ak),at=Site.checkModuleInZone(ak),aB=ak.outerWidth(),aj=ak.outerHeight(),aG=ak.offset(),ap=aG.left,ar=aG.top,aI=ap+aB,ah=ar+aj,aP=Fai.top.$(".floatRightBottom").offset(),aF=Fai.top.$(".floatLeftTop").offset(),aO=aP.left,aQ=aP.top,an=Fai.getScrollWidth(),aE=Fai.top.$("#g_main"),aS=aE.scrollTop(),aN=aC.outerWidth(),aM=aC.outerHeight(),al=0,aw=0,aK=0,az=false,ao="",au=false,aH=false,ay=0,aq,av,am,aJ,ai;ax(aA.isDialog);function aL(){if(aR.isFullmeasure){al=aO-aN;aw=ar-aM;ao="fk-moduleToolbar-left";if(aw<aF.top){aw=aF.top}aC.css({right:an+"px",top:aw+"px"})}else{if(ak.find(".formMiddleContent"+aD).children(".pd_mall_G_J").length>0||ak.find(".formMiddleContent"+aD).children(".navA_C_J").length>0){au=true}if(aI<=(aO-aN)&&!aR.inMulCol&&!aR.inTab&&!au){al=aI;aw=ar;ao="fk-moduleToolbar-right";ay=2}else{if(ap>=aN){al=ap-aN;aw=ar;ao="fk-moduleToolbar-left";aH=true;ay=1}else{if((ar-aF.top)>=38){ao="fk-moduleToolbar-top";aC.removeClass("fk-moduleToolbar-left fk-moduleToolbar-right fk-moduleToolbar-top fk-moduleToolbar-bottom").addClass(ao);aN=aC.outerWidth();aM=aC.outerHeight();al=aI-aN;aw=ar-aM;ay=3}else{if((ah+38)<=aQ){ao="fk-moduleToolbar-bottom";aC.removeClass("fk-moduleToolbar-left fk-moduleToolbar-right fk-moduleToolbar-top fk-moduleToolbar-bottom").addClass(ao);aN=aC.outerWidth();aM=aC.outerHeight();al=aI-aN;aw=ah;ay=4}else{al=ap;aw=ar;ao="fk-moduleToolbar-left";aH=true;ay=5}}}}if(aR.inPack||at){if(at){aq=ak.parent()}else{aq=Fai.top.$("#module"+aR.inPackId)}aJ=aq.offset().left;ai=aq.offset().top;av=aJ+aq.width();am=ai+aq.height();if(ay==2){if(al>av){al=av}if(aw<ai){aw=ai}}else{if(ay==1){if(al<aJ){if(ap<aJ){al=aJ-aN}else{al=ap-aN}}if(aw<ai){aw=ai}}else{if(ay==3){if(aw<ai){tooTop=ai}if((al+aN)>av){al=av-aN}}else{if(ay==4){if((aN+al)>av){al=av-aN}if((aw+aM)>am){aw=am-aM}}else{if(ay==5){if(al<aJ){al=aJ-aN;if(al<0){al=aJ}}if(aw<ai){aw=ai}}}}}}}switch(ay){case 1:case 2:if(aQ<(aw+aM)){az=true;aK=0}else{if(aw<aF.top){aw=aF.top}}break;case 3:case 4:case 5:if(al<0){al=0}else{if((al+aN)>(aO-an)){al=aO-aN-an}}if(aw<aF.top){aw=aF.top}break;default:}if(az){aC.css({left:al+"px",bottom:aK+"px"})}else{aC.css({left:al+"px",top:aw+"px"})}if(aR.isMultiModule||aR.isPack){var aU=document.createElement("div"),aT="fk-multiDragBtn-left";if(typeof aU.style.borderRadius=="undefined"){aT+=" fk-multiDragBtn-left-low";aU=null}if(aR.isTab){aH?ak.find(".J_tabHandle").addClass(aT):ak.find(".J_tabHandle").removeClass(aT)}else{if(aR.isMulCol){aH?ak.find(".J_multiHandle").addClass(aT):ak.find(".J_multiHandle").removeClass(aT)}else{if(aR.isPack){aH?ak.find(".J_packHandle").addClass(aT):ak.find(".J_packHandle").removeClass(aT)}}}}}aC.removeClass("fk-moduleToolbar-left fk-moduleToolbar-right fk-moduleToolbar-top fk-moduleToolbar-bottom").addClass(ao)}function ax(aX){var aW,aV="fk-multiDragBtn-left",aU,aY=aF.top,aT,a0=0,aZ=0;if(!!aX){aY=0}if((aR.isMultiModule||aR.isPack)&&(aR.inMulCol||aR.inTab)){aW=document.createElement("div");aH=true;if(typeof aW.style.borderRadius=="undefined"){aV+=" fk-multiDragBtn-left-low";aW=null}}if(aR.isTab&&!aR.isTabY){aH?ak.find(".J_tabHandle").addClass(aV):ak.find(".J_tabHandle").removeClass(aV)}else{if(aR.isMulCol){aH?ak.find(".J_multiHandle").addClass(aV):ak.find(".J_multiHandle").removeClass(aV)}else{if(aR.isPack){aH?ak.find(".J_packHandle").addClass(aV):ak.find(".J_packHandle").removeClass(aV)}}}if(aR.isTabY){ak.find(".J_tabHandle").addClass(aV);aH=true}aw=ar-aM-4;al=aH?ap:(aI-aN);if(aR.inPack||at){if(at){aq=ak.parent()}else{aq=Fai.top.$("#module"+aR.inPackId);aT=aq.find(".formBanner"+aR.inPackId);if(aT.is(":visible")){a0=aT.height()}}aJ=aq.offset().left;ai=aq.offset().top+a0;av=aJ+aq.width();am=ai+aq.height();if((aN+al)>av){al=av-aN}if(ar<ai){aw=ai-aM-4}}if(aw<aY){if(aj<100){aw=ar+aj+4}else{aw=aY}}if((aR.isMultiModule||aR.isPack)&&(ar+aS<=aY+aM)){aU=ak.find(">.J_dragHandle");if(aU.hasClass("fk-multiDragBtn-left")){al=al+aU.width()}else{al=al-aU.width()}}if(al<0){al=0}else{if((al+aN)>(aO-an)){al=aO-aN-an}}if(aR.isFullmeasure){if(Fai.top.$("#J_WebRightBar").is(":visible")){aZ=Fai.top.$("#J_WebRightBarList").outerWidth()+1;M(ak).find(">.J_fullmeasureHandle").addClass("fk-fullmeasureDragBtn-rightbar")}else{aZ=0;M(ak).find(">.J_fullmeasureHandle").removeClass("fk-fullmeasureDragBtn-rightbar")}aC.css({right:an+aZ+"px",top:aw+"px"})}else{aC.css({left:al+"px",top:aw+"px"})}}}function C(ah){var ai=Fai.top.$("#module"+ah.id),ak=I(ai),am=-1,al,aj;if(ak.inTabId>0){am=ak.inTabId}else{if(ak.inMulColId>0){am=ak.inMulColId}else{if(ak.inFullmeasureId>0){am=ak.inFullmeasureId}else{if(ak.inPackId>0){am=ak.inPackId}}}}U(ah.id);x(ah.id);q(ai,ah.id);X(ah.id);P(ah.id);if(!w.getContextMenu(ah.id)){Site.removeMoveFrame("module"+ah.id)}if(ai.attr("_side")=="2"&&ai.attr("_flutterSwitch")!="true"){Site.startFlutterInterval(ai);w.clearAll(ah.id)}else{if(ai.attr("_side")=="1"){Y(ah.id,"leaveSideModule");al=setTimeout(function(){if(!w.getStatus(ah.id)&&!w.getContextMenu(ah.id)&&Fai.top.$(".fk-moduleContextMenu"+ah.id).length<1&&Fai.top.$(".moduleMaskContainer").length<1){Site.reSetSidePosition(ai);w.clearAll(ah.id)}},300);y(ah.id,"leaveSideModule",al)}else{w.clearAll(ah.id)}}if(am>0&&!w.getStatus(am)){Y(am,"leaveParentModule");aj=setTimeout(function(){var an=Fai.top.$("#module"+ah.id),ao=I(an),ap=-1;if(ao.inTabId>0){ap=ao.inTabId}else{if(ao.inMulColId>0){ap=ao.inMulColId}else{if(ao.inFullmeasureId>0){ap=ao.inFullmeasureId}else{if(ao.inPackId>0){ap=ao.inPackId}}}}if(ao.inPackId>0&&Fai.top.$("#module"+ap).attr("_side")==1){return}C({id:ap})},300);y(am,"leaveParentModule",aj)}}function I(aj){if(Object.prototype.toString.call(aj).toLowerCase()!="[object object]"){throw new Error("Site.moduleEditTool getModuleData 参数错误");return}var ao=false,ah=false,au=0,ai=false,am=false,an=false,at=0,ax=false,ak=false,ar=0,ap=false,aw=false,al=false,av=false,aq=0;if(aj.hasClass("formStyle80")){ao=true}else{if(aj.hasClass("formStyle35")){ax=true}else{if(aj.hasClass("formStyle29")){ai=true;if(aj.hasClass("fk-formTabY")){am=true}}else{if(aj.hasClass("formStyle87")){al=true}}}}au=aj.attr("_infullmeasure")||0;if(au>0){ah=true}at=aj.attr("_intab")||0;if(at>0){an=true}ar=aj.attr("_inmulmcol")||0;if(ar>0){ak=true}aq=parseInt(aj.attr("_inpack"))||0;if(aq>0){av=true}if(ai||ax){ap=true}if(an||ak){aw=true}return{isFullmeasure:ao,inFullmeasure:ah,inFullmeasureId:au,isTab:ai,isTabY:am,inTab:an,inTabId:at,isMulCol:ax,inMulCol:ak,inMulColId:ar,isMultiModule:ap,inMultiModule:aw,isPack:al,inPack:av,inPackId:aq}}function af(ai){var aj=Fai.top.$("#module"+ai);if(aj.length<1){return}var am=I(aj),ap=false;function aq(av,aw){return aw.indexOf(parseInt(av.attr("_modulestyle")))>-1}function al(ax,aw){var av=Site.getModuleStatus(ax);if(aw.indexOf(av)>-1){return true}return false}function ar(aw){var av=aw.find(".J_moduleTmpMask");if(av.length!==0){av.off("mousemove.removeMask mousedown.removeMask");M("body").off("mouseup.changeFlag");aw.removeData("isModuleDown");av.remove()}}function at(aw){var av=aw.find(".J_moduleTmpMask");if(av.length===0){av=M("<div class='J_moduleTmpMask fk-moduleTmpMask'></div>");av.off("mousemove.removeMask mousedown.removeMask").on("mousemove.removeMask mousedown.removeMask",function(){if(!aw.data("isModuleDown")){ar(aw);aw.find(".J_dragHandle").show()}});M("body").off("mouseup.changeFlag").on("mouseup.changeFlag",function(){var ax=M("body");if(ax.length>0){aw.removeData("isModuleDown");ax.off("mouseup.changeFlag")}});aj.find("iframe").parent().append(av)}}if(!am.isMultiModule&&!am.isFullmeasure&&!am.isPack){if(aj.hasClass("formStyle18")||aj.hasClass("formStyle36")||aj.hasClass("formStyle17")||aj.hasClass("formStyle20")||aj.hasClass("formStyle72")){if(aj.find(".formBanner").is(":visible")){return}}else{return}if(aj.children(".draggableBtn").find(".J_handle").length<1){var an=[],au=30,ak=aj.width()/2-au;an.push("<div class='J_dragHandle draggableBtn' _mouseIn='0' style='left:"+ak+"px;'>");an.push("<a href='javascript:;' onclick='return false;' class='J_handle dragHandle'></a>");an.push("</div>");aj.append(an.join(""));if(aq(aj,[20,72,18])){if(al(ai,[2,3,4])){aj.find(".J_dragHandle").off("mousedown.createMask").on(" mousedown.createMask",function(){aj.removeData("isModuleDown");ar(aj);aj.data("isModuleDown",true);at(aj)})}else{if(al(ai,[1])){aj.off("mousedown.createMask").on(" mousedown.createMask",function(){aj.removeData("isModuleDown");ar(aj);aj.data("isModuleDown",true);at(aj)})}}}aj.off("Fai_onModuleSizeChange.dragBtn").off("Fai_onModuleLayoutChange.dragBtn").on("Fai_onModuleSizeChange.dragBtn",function(){Site.fixDragBtnPos(M(this))}).on("Fai_onModuleLayoutChange.dragBtn",function(){Site.fixDragBtnPos(M(this))});ap=true}}else{var ah=document.createElement("div"),ao="fk-multiDragBtn";if(typeof ah.style.borderRadius=="undefined"){ao="fk-multiDragBtn-low";ah=null}if(am.isMulCol&&aj.find(".J_multiHandle").length<1){aj.append('<div class="J_dragHandle J_multiHandle '+ao+'" title="按住鼠标，可随意拖动多列排版模块布局。"></div>');ap=true}else{if(am.isTab&&aj.find(".J_tabHandle").length<1){if(am.isTabY){ao+=" fk-multiDragBtn-left "}aj.append('<div class="J_dragHandle J_tabHandle '+ao+'" title="按住鼠标，可随意拖动标签模块布局。"></div>');aj.find(".formTabButton").attr("title","按住鼠标，可随意调整标签模块内模块顺序");aj.find(".formTab").addClass("column");ap=true}else{if(am.isFullmeasure&&aj.find(".J_fullmeasureHandle").length<1){aj.append('<div class="J_dragHandle J_fullmeasureHandle fk-fullmeasureDragBtn" title="按住鼠标，可随意拖动通栏模块布局。"></div>');ap=true}else{if(am.isPack&&aj.find(".J_packHandle").length<1){aj.append('<div class="J_dragHandle J_packHandle f-packHandle '+ao+'" title="按住鼠标，可随意拖动自由容器布局。"></div>');ap=true}}}}}if(ap){Site.addDragBtnHandle(aj);i(ai)}else{Site.fixDragBtnPos(aj)}ae(ai)}function X(aj){var ah=Fai.top.$("#module"+aj);if(ah.length<1){return}var ai=I(ah);if(ai.isTab){ah.find(".J_tabHandle").hide()}else{if(ai.isMulCol){ah.find(".J_multiHandle").hide()}else{if(ai.isFullmeasure){ah.find(".J_fullmeasureHandle").hide()}else{if(ai.isPack){ah.find(".J_packHandle").hide()}else{ah.children(".draggableBtn").hide()}}}}}function Q(ak){var ai=Fai.top.$("#module"+ak);if(ai.length<1){return}var aj=I(ai),ah="fk-halfHide";if(aj.isTab){ai.find(".J_tabHandle").addClass("fk-halfHide")}else{if(aj.isMulCol){ai.find(".J_multiHandle").addClass("fk-halfHide")}else{if(aj.isFullmeasure){ai.find(".J_fullmeasureHandle").addClass("fk-halfHide")}else{if(aj.isPack){ai.find(".J_packHandle").addClass("fk-halfHide")}else{ai.children(".draggableBtn").addClass("fk-halfHide")}}}}}function ae(aj){var ah=Fai.top.$("#module"+aj);if(ah.length<1){return}var ai=I(ah);if(ai.isTab){ah.find(".J_tabHandle").stop().removeClass("fk-halfHide").show()}else{if(ai.isMulCol){ah.find(".J_multiHandle").stop().removeClass("fk-halfHide").show()}else{if(ai.isFullmeasure){ah.find(".J_fullmeasureHandle").stop().removeClass("fk-halfHide").show()}else{if(ai.isPack){ah.find(".J_packHandle").stop().removeClass("fk-halfHide").show()}else{ah.children(".draggableBtn").stop().removeClass("fk-halfHide").show()}}}}}function ag(ai,ah){if(typeof ah=="number"){Fai.top.$("#fk-moduleToolbar"+ai).stop().fadeOut(ah)}else{Fai.top.$("#fk-moduleToolbar"+ai).stop().hide()}}function O(ah){Fai.top.$("#fk-moduleToolbar"+ah).stop().css("opacity",1).show()}function i(ak){var ai=Fai.top.$("#module"+ak);if(ai.length<1){return}var aj=I(ai),ah;if(aj.isTab){ah=ai.find(".J_tabHandle")}else{if(aj.isMulCol){ah=ai.find(".J_multiHandle")}else{if(aj.isFullmeasure){ah=ai.find(".J_fullmeasureHandle")}else{if(aj.isPack){ah=ai.find(".J_packHandle")}else{ah=ai.children(".draggableBtn")}}}}ah.off("mouseover.moduleEdit").off("mouseleave.moduleEdit").on("mouseover.moduleEdit",function(al){w.isActive(ak,"dragBtn");w.lock(ak);Y(ak,"dragBtnMouseover");var am=setTimeout(function(){var an=I(Fai.top.$("#module"+ak));if(an.isMultiModule||an.isFullmeasure||an.isPack){O(ak);G(ak)}else{if(w.getActivePart(ak)==2){ag(ak,400);P(ak)}}Y(ak,"dragBtnMouseover")},300);y(ak,"dragBtnMouseover",am)}).on("mouseleave.moduleEdit",function(al){w.open(ak);w.isLeave(ak);Y(ak,"dragBtnMouseover");var am=setTimeout(function(){if(w.getStatus(ak)&&w.getActivePart(ak)!=4){O(ak);G(ak)}},100);y(ak,"dragBtnMouseleave",am)})}function G(aj){var ah=Fai.top.$("#module"+aj),ai=ah.children(".J_resizableTip");if(ah.length<1){return}ai.show()}function P(aj){var ah=Fai.top.$("#module"+aj),ai=ah.children(".J_resizableTip");if(ah.length<1){return}ai.hide()}function ab(ai){var ah=Fai.top.$("#module"+ai);if(ah.length<1){return}ah.children(".J_lockEditTip").show()}function B(ai){var ah=Fai.top.$("#module"+ai);if(ah.length<1){return}ah.children(".J_lockEditTip").hide()}function o(ai){var ah=Fai.top.$("#module"+ai);if(ah.length<1){return}if(ah.data("lockedit")!="lock"){ah.children(".J_lockEditTip").remove();return true}else{return false}}function y(aj,ah,ai){L[aj]=L[aj]||{};L[aj][ah]=ai}function Y(ai,ah){if(L[ai]&&L[ai][ah]){clearTimeout(L[ai][ah]);delete L[ai][ah]}}function U(ai){var ah;if(L[ai]){for(ah in L[ai]){if(L[ai].hasOwnProperty(ah)){clearTimeout(L[ai][ah]);delete L[ai][ah]}}delete L[ai]}}function S(){var ah;for(ah in L){if(L.hasOwnProperty(ah)){U(ah)}}L=[]}function f(){Fai.top.$("#fk-moduleEditToolGuide").remove()}function n(ai){var ah=ai.name||"",aj=ai.value,ak=ai.time||90;if(window.localStorage&&window.localStorage.setItem){window.localStorage.setItem(ah,aj)}else{M.cookie("moduleEditToolPrompt","1",{expires:ak,path:"/"})}}function k(ai){var ah=ai.name||"",aj=false;if(window.localStorage&&window.localStorage.getItem){aj=window.localStorage.getItem(ah)}else{aj=M.cookie("moduleEditToolPrompt",{path:"/"})}return aj}function T(ak){var ah=Fai.top.$("#module"+ak),aj=v(ak),ai=Site.checkNestModule(ah);ah.data("lockedit","lock");Site.removeMoveFrame("module"+ak);Site.addMoveFrame("module"+ak);ah.addClass("formLockEdit");if(ai.nest){ah.find(".form").data("lockedit","lock").addClass("formLockEdit")}if(ai.inPack){ah.resizable("destroy");ah.children(".ui-resizable-cancelTip").remove()}else{if(aj==1){Site.dockModuleResize_disable(ah)}else{ah.draggable("destroy");ah.resizable("destroy");ah.children(".ui-resizable-cancelTip").remove()}}if(ai.isPack){jzUtils.run({name:"_elemZone.packChildrenDisableResizable",base:Fai.top},ah)}ah.append("<a href='javascript:;' onclick='Site.moduleEditTool.clickForOpenEdit("+ak+");return false;' class='J_lockEditTip fk-setEditTip fk-lockEditTip' title='解锁当前排版'></a>")}function m(ak){var ah=Fai.top.$("#module"+ak),aj=v(ak),ai=Site.checkNestModule(ah);ah.removeData("lockedit");Site.removeMoveFrame("module"+ak);Site.addMoveFrame("module"+ak);ah.removeClass("formLockEdit");if(ai.nest){ah.find(".form").removeData("lockedit").removeClass("formLockEdit")}if(ai.inPack){jzUtils.run({name:"_elemZone.resizeZoneOneModule",base:Fai.top},ah)}else{if(aj==1){Site.dockModuleResize(ah)}else{Site.floatModuleDraggable(ah)}if(ai.isPack){jzUtils.run({name:"_elemZone.resizeOneZoneModule",base:Fai.top},ah)}}}function v(aj){var ai=1,ah="module"+aj;if(Site.getFlutterStatus2(ah)==0){ai=4}else{if(Site.getSideStatus(ah)==0){ai=5}else{if(Site.getLockStatus(ah)==0){ai=3}else{if(Site.getAbsStatus(ah)==0){ai=2}}}}return ai}function N(an,ai){return;var aj=false,aq={},ao={},ap=Site.checkNestModule(an),am=["absTopForms","absForms","absBottomForms","floatLeftTopForms","floatRightTopForms","floatLeftBottomForms","floatRightBottomForms"],ah,ak,al;if(an.hasClass("J_checkModuleZIndexDone")||ap.inPack){return}if(ap.inPack){am=["fk-packContent"+ap.parentId]}else{ah=v(ai);if(ah!=2&&ah!=3){return}}aq.x=an.offset().left;aq.y=an.offset().top;aq.w=an.width();aq.h=an.height();aj=g({id:"module"+ai,rect1:aq,formsIdList:am});an.addClass("J_checkModuleZIndexDone");if(!aj){return}an.addClass("fk-maxModuleZindex");an.parent(".forms").addClass("fk-maxFormsZIndex");ak=Fai.top.$("#fk-moduleToolbar"+ai);if(ak.length>0){al=Site.getModuleAttrPattern(ai);if(al.border.y==1&&al.contentBg.y==1&&al.bannerType==1){an.addClass("fk-hoverModule")}}if(an.data("simpleText")&&!an.find("#fkEditor-"+ai).attr("contenteditable")){an.addClass("fk-hoverModule")}}function g(am){var aq=am.rect1,ai=am.id,ao=am.formsIdList,ak=false,ah,aj,an,ap;for(var al=0;al<ao.length;al++){ah=Fai.top.$("#"+ao[al]).children(".form");ah.each(function(ar,at){aj=M(at);if(aj.attr("id")==ai){return true}an=aj.offset();ap={};ap.w=aj.width();ap.h=aj.height();ap.x=an.left;ap.y=an.top;ak=e(aq,ap);if(ak){return false}});if(ak){break}}return ak}function q(ai,ah){ai.removeClass("fk-maxModuleZindex fk-hoverModule J_checkModuleZIndexDone");ai.parent(".forms").removeClass("fk-maxFormsZIndex")}function e(ai,ah){if(ah.x>=(ai.x+ai.w)){}else{if((ah.x+ah.w)<=ai.x){}else{if((ah.y+ah.h)<=ai.y){}else{if((ai.y+ai.h)<ah.y){}else{return true}}}}return false}})(jQuery,Site.moduleEditTool);